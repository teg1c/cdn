webpackJsonp([69],{"+WhD":function(t,e){},"9rYQ":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("mvHQ"),a=s.n(i),r=s("Gu7T"),o=s.n(r),l=s("Cz8s"),n=s("+TmT"),c={components:{PublicHeader:l.a,Uploader:n.a},data:function(){return{id:0,records:[],islegal:!1,showPreLoading:!0}},methods:{onLoad:function(){var t=this;if(!this.id)return this.util.$toast("订单不存在或已删除！",this.util.getUrl({path:"/mall/pages/order/index",query:{}}),1500,"replace"),!1;this.util.request({url:"wmall/mall/comment/index",data:{id:this.id}}).then(function(e){t.showPreLoading=!1;var s=e.data.message;s.errno?t.$toast(s.message):(t.islegal=!0,s=s.message,t.records=[].concat(o()(s.records)))}),this.util.isGlala()&&this.util.requestPermissionList({perm:["storage","camera","photos"]})},favorOppose:function(t,e,s){this.records[e].goods[t].activity=s},onGetImgsUrl:function(t){this.records[t.index].thumbs=[].concat(o()(t.value))},onSubmit:function(){var t=this;if(!this.islegal)return!1;var e=this.records;for(var s in e){if(1==e[s].order.order_type&&0==e[s].order.parent_oid&&!e[s].delivery_service)return this.util.$toast("请您评价配送服务"),!1;if(!e[s].goods_quality)return this.util.$toast("请您评价商品质量"),!1}var i={id:this.id,records:a()(e)};this.util.request({url:"wmall/mall/comment/post",method:"post",data:i}).then(function(e){var s=e.data.message;if(s.errno)return t.util.$toast(s.message),!1;t.util.$toast(s.message,t.util.getUrl({path:"/mall/pages/order/detail",query:{id:t.id}}),1500,"replace")})}},mounted:function(){var t=this.util.parseQuery(this.$route.query);this.id=t.id,this.onLoad()}},d={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"mall-order-comment"}},[s("public-header",{attrs:{title:"添加评论"}}),t._v(" "),s("div",{staticClass:"content"},[t._l(t.records,function(e,i){return[1==e.order.order_type&&0==e.order.parent_oid?[s("div",{staticClass:"delivery-service"},[t._m(0,!0),t._v(" "),s("van-cell-group",[s("van-cell",[s("div",{staticClass:"flex",attrs:{slot:"title"},slot:"title"},[s("span",{staticClass:"van-cell-text"},[t._v("配送服务")]),t._v(" "),s("van-rate",{staticClass:"flex",attrs:{size:20,count:5,color:"#ff2d4b","void-color":"#FF6C81"},model:{value:e.delivery_service,callback:function(s){t.$set(e,"delivery_service",s)},expression:"record.delivery_service"}})],1)])],1)],1)]:t._e(),t._v(" "),s("div",{staticClass:"record-item"},[s("div",{staticClass:"content-block-title van-hairline--bottom"},[s("i",{staticClass:"icon icon-shop font-16"}),t._v(" "),s("span",[t._v(t._s(e.store.title))])]),t._v(" "),s("van-cell-group",{staticClass:"border-0px"},[s("van-cell",[s("div",{staticClass:"flex",attrs:{slot:"title"},slot:"title"},[s("span",{staticClass:"van-cell-text"},[t._v("商品质量")]),t._v(" "),s("van-rate",{staticClass:"flex",attrs:{size:20,count:5,color:"#ff2d4b","void-color":"#FF6C81"},model:{value:e.goods_quality,callback:function(s){t.$set(e,"goods_quality",s)},expression:"record.goods_quality"}})],1)]),t._v(" "),t._l(e.goods,function(e,a){return s("van-cell",{key:a,attrs:{title:e.goods_title}},[s("div",{staticClass:"favor-oppose",attrs:{slot:"right-icon"},slot:"right-icon"},[s("label",{on:{click:function(e){return t.favorOppose(a,i,1)}}},[s("input",{staticClass:"radio",attrs:{type:"radio",value:"1"},domProps:{checked:1==e.activity}}),t._v(" "),s("span",{staticClass:"favor"})]),t._v(" "),s("label",{on:{click:function(e){return t.favorOppose(a,i,2)}}},[s("input",{staticClass:"radio",attrs:{type:"radio",value:"2"},domProps:{checked:2==e.activity}}),t._v(" "),s("span",{staticClass:"oppose"})])])])})],2),t._v(" "),t._m(1,!0),t._v(" "),s("div",{staticClass:"content-block-title van-hairline--bottom"},[t._v("写点什么")]),t._v(" "),s("van-cell-group",{staticClass:"border-0px"},[s("van-field",{attrs:{type:"textarea",placeholder:"至少输入10个字，您的建议很重要，来点评一下吧"},model:{value:e.note,callback:function(s){t.$set(e,"note",s)},expression:"record.note"}})],1),t._v(" "),t._m(2,!0),t._v(" "),s("div",{staticClass:"content-block-title van-hairline--bottom"},[t._v("有图有真相")]),t._v(" "),s("uploader",{attrs:{value:e.thumbs,max:6,multiple:1,uploaderIndex:i},on:{onGetUrl:t.onGetImgsUrl}})],1)]}),t._v(" "),s("div",{staticClass:"save-btn"},[s("van-button",{attrs:{size:"large"},on:{click:function(e){return t.onSubmit()}}},[t._v("提交评论")])],1)],2),t._v(" "),t.showPreLoading?s("iloading"):t._e()],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"content-block-title"},[e("i",{staticClass:"icon icon-waimai font-18"}),this._v(" "),e("span",[this._v("配送评价")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"divide"},[e("div",{staticClass:"divide-line"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"divide"},[e("div",{staticClass:"divide-line"})])}]};var v=s("VU/8")(c,d,!1,function(t){s("+WhD")},null,null);e.default=v.exports}});
//# sourceMappingURL=69.fd8d5d433b8311f1044b.js.map