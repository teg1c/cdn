webpackJsonp([231],{nd0U:function(t,s){},xEUG:function(t,s,o){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var i=o("Dd8w"),a=o.n(i),n=o("Gu7T"),e=o.n(n),c=o("NYxO"),l={data:function(){return{city:{title:"",url:""},getLocationFail:!1,addresses:[],searchAddress:[],showSearch:!1,key:"",getNowLocationing:!1,MapType:"gaode",showPreLoading:!0}},components:{PublicHeader:o("Cz8s").a},watch:{key:function(){var t=this,s=this.key;this.showSearch=!!s,this.searchAddress=[];var o="system/common/map/suggestion";"google"==this.MapType&&(o="system/common/map/suggestion_google"),s&&this.util.request({url:o,data:{key:s}}).then(function(s){var o=s.data.message;o.errno||(t.searchAddress=[].concat(e()(o.message)))})}},methods:a()({},Object(c.b)(["setLocation","getLocation"]),{onLoad:function(){var t=this;this.util.request({url:"wmall/home/newLocation/index"}).then(function(s){t.showPreLoading=!1;var o=s.data.message;o.errno||(o=o.message,t.addresses=[].concat(e()(t.addresses),e()(o.addresses)),t.city=t.util.extend(t.city,o.city),!t.city.title&&t.locationInfo.city&&(t.city.title=t.locationInfo.city),t.MapType=t.util.getStorage("MapType"))})},chooseLocation:function(t){var s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o={last_location_x:this.locationInfo.location_x,address:t.address,location_x:t.location_x,location_y:t.location_y,city:this.city.title};this.setLocation(o),s&&(o.name=t.name),this.$router.go(-1)},onGetNowLocation:function(){var t=this;t.getNowLocationing=!0,t.util.getLocation({successLocation:function(t){},successAddress:function(s){t.setLocation({location_x:s.location_x,location_y:s.location_y,address:s.address,province:s.province,city:s.city,district:s.district,township:s.township}),t.getNowLocationing=!1,this.$router.go(-1)},fail:function(s){t.getNowLocationing=!1,t.util.$toast("获取定位失败,你可以手动搜索收货地址")},MapType:t.MapType})},onInit:function(){var t=this;t.getLocation(),t.locationInfo.location_x?(t.getLocationFail=!1,t.locationInfo.last_location_x=this.locationInfo.location_x,t.onLoad()):t.util.getLocation({successLocation:function(s){t.setLocation({location_x:s.location_x,location_y:s.location_y}),t.onLoad()},successAddress:function(s){t.setLocation({location_x:s.location_x,location_y:s.location_y,address:s.address,province:s.province,city:s.city,district:s.district,township:s.township})},fail:function(s){t.setLocation({last_location_x:0,location_x:0,address:"获取定位失败"}),t.getLocationFail=!0,t.onLoad()}})}}),computed:a()({},Object(c.c)(["locationInfo"])),mounted:function(){this.$route.query.m?this.onLoad():this.onInit()}},r={render:function(){var t=this,s=t.$createElement,o=t._self._c||s;return o("div",{attrs:{id:"location"}},[o("public-header",{attrs:{title:"选择收货地址"},on:{onClickRight:function(s){return t.util.jsUrl("/pages/member/addressPost",{channel:"location"},"replace")}}},[o("div",{staticClass:"font-14",attrs:{slot:"right"},slot:"right"},[t._v("新增地址")])]),t._v(" "),o("div",{staticClass:"container"},[o("div",{staticClass:"search-bar"},[o("form",{attrs:{action:"/"}},[o("van-search",{attrs:{placeholder:"请输入您的收货地址",shape:"round",clearable:""},model:{value:t.key,callback:function(s){t.key=s},expression:"key"}},[o("div",{staticClass:"search-left",attrs:{slot:"left"},on:{click:function(s){return t.util.jsUrl(t.city.url,{},"replace")}},slot:"left"},[o("div",{staticClass:"icon icon-location"}),t._v(" "),o("div",{staticClass:"city"},[t._v(t._s(t.city.title))]),t._v(" "),t.city.url?o("div",{staticClass:"icon icon-unfold"}):t._e()])])],1)]),t._v(" "),t.showSearch?[t.searchAddress.length>0?o("div",{staticClass:"search-list"},t._l(t.searchAddress,function(s,i){return o("div",{key:i,staticClass:"search-item",class:{"van-hairline--top":i>0},on:{click:function(o){return t.chooseLocation(s,!0)}}},[o("van-row",[o("van-col",{attrs:{span:"24"}},[o("div",{staticClass:"address-text ellipsis"},[t._v(t._s(s.address))])]),t._v(" "),t._e()],1),t._v(" "),o("div",{staticClass:"address-desc ellipsis"},[t._v(t._s(s.name))])],1)}),0):o("van-empty",{attrs:{description:"未匹配到地址~"}})]:[o("div",{staticClass:"van-hairline--bottom"},[o("van-row",{staticClass:"now-address"},[o("van-col",{attrs:{span:"16"}},[o("div",{staticClass:"address-text"},[t._v(t._s(t.locationInfo.address?t.locationInfo.address:"获取定位失败"))])]),t._v(" "),o("van-col",{attrs:{span:"8"}},[o("div",{staticClass:"to-location",on:{click:t.onGetNowLocation}},[o("div",{staticClass:"icon icon-locationfill font-16 margin-5-r"}),t._v(" "),o("div",[t._v(t._s(t.locationInfo.location_x?"重新获取定位":"获取定位"))])])])],1)],1),t._v(" "),t.addresses.length>0?[t._m(0),t._v(" "),o("div",{staticClass:"address-list"},t._l(t.addresses,function(s,i){return o("div",{key:i,staticClass:"address-item van-hairline--bottom",on:{click:function(o){return t.chooseLocation(s)}}},[o("div",{staticClass:"address-text"},[s.tag>=1&&s.tag<=3?o("div",{staticClass:"label",class:"label-"+s.tag},[t._v(t._s(s.tag_cn))]):t._e(),t._v("\n\t\t\t\t\t\t\t"+t._s(s.address)+"\n\t\t\t\t\t\t")]),t._v(" "),o("div",{staticClass:"member"},[o("div",[t._v(t._s(s.realname))]),t._v(" "),o("div",{staticClass:"sex"},[t._v(t._s(s.sex))]),t._v(" "),o("div",[t._v(t._s(s.mobile))])])])}),0)]:[o("van-empty",{attrs:{description:"暂无收货地址"}})]]],2),t._v(" "),t.showPreLoading?o("iloading"):t._e()],1)},staticRenderFns:[function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"headline"},[s("div",{staticClass:"icon icon-home"}),this._v(" "),s("div",[this._v("我的收货地址")])])}]};var d=o("VU/8")(l,r,!1,function(t){o("nd0U")},null,null);s.default=d.exports}});
//# sourceMappingURL=231.fe89945d6f499efc649b.js.map