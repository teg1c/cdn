webpackJsonp([259],{"67SL":function(t,s,a){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var i=a("Cz8s"),e=a("mzkE"),n={components:{PublicHeader:i.a,PublicFooter:e.a},data:function(){return{showPreLoading:!0,agreementShow:!1,year:"",month:"",calendar:[],continuous_get:[],all_get:[],credit_days_amount:{},member:{},config:{text:{sign:"签到"},style:{maincolor:"#ff2d4b"},reward:{total:[],continue:[]}},grantType:"",menufooter:{}}},methods:{onLoad:function(){var t=this;this.util.request({url:"creditsign/index",data:{menufooter:1}}).then(function(s){t.showPreLoading=!1;var a=s.data.message;if(a.errno)return t.util.$toast(a.message),!1;a=a.message,t.year=a.year,t.month=a.month,t.calendar=a.calendar,t.continuous_get=a.continuous_get,t.all_get=a.all_get,t.credit_days_amount=a.credit_days_amount,t.member=a.member,t.config=t.util.extend(t.config,a.config),t.grantType=a.grantType,t.menufooter=window.menufooter,t.$nextTick(function(){var s=document.getElementsByClassName("van-nav-bar");s&&s.length>0&&(s[0].style.background=t.config.style.maincolor)})})},onGetReward:function(t,s,a,i){var e=this;if(!t||!s)return this.$toast("您还没有达到领取该奖励的条件"),!1;this.util.request({url:"creditsign/index/get",data:{days:s,type:t},method:"POST"}).then(function(n){var o=n.data.message;if(e.$toast(o.message),o.errno)return!1;1==a&&(1==t?(e.config.reward.continue[i].status=2,e.continuous_get[s]={days:s}):2==t&&(e.config.reward.total[i].status=2,e.all_get[s]={days:s}))})},onDayClick:function(t,s){var a=this,i=t-(new Date).getDate();this.util.request({url:"creditsign/index/next",data:{difference:i,grant:s}}).then(function(t){a.$dialog.alert({message:t.data.message.message,showConfirmButton:!1,closeOnClickOverlay:!0})})}},mounted:function(){this.onLoad()}},o={render:function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{attrs:{id:"creditsign-index"}},[a("public-header",{attrs:{title:"积分"+t.config.text.sign}}),t._v(" "),a("public-footer",{attrs:{preLoading:t.showPreLoading,menufooter:t.menufooter}}),t._v(" "),a("div",{staticClass:"content"},[a("div",{staticClass:"banner",style:{backgroundColor:t.config.style.maincolor?t.config.style.maincolor:"#ff2d4b"}},[a("div",{staticClass:"avatar"},[a("img",{attrs:{src:t.member.avatar,alt:""}})]),t._v(" "),a("router-link",{staticClass:"detail",attrs:{to:t.util.getUrl({path:"/plugin/pages/creditsign/record"})}},[t._v("详细记录")]),t._v(" "),a("div",{staticClass:"agreement",on:{click:function(s){t.agreementShow=!0}}},[t._v("活动规则")]),t._v(" "),a("div",{staticClass:"gutter"},[a("div",{staticClass:"col-33"},[a("div",{staticClass:"titles"},[t._v("连续"+t._s(t.config.text.sign))]),t._v(" "),a("div",{staticClass:"days"},[t._v(t._s(t.credit_days_amount.continuous)+"天")])]),t._v(" "),a("div",{staticClass:"col-33"},[a("div",{staticClass:"titles"},[t._v(t._s(t.member.nickname))])]),t._v(" "),a("div",{staticClass:"col-33"},[a("div",{staticClass:"titles"},[t._v("累计"+t._s(t.config.text.sign))]),t._v(" "),a("div",{staticClass:"days"},[t._v(t._s(t.credit_days_amount.sum)+"天")])])])],1),t._v(" "),a("div",{staticClass:"calendar"},[a("div",{staticClass:"titles",style:{color:t.config.style.maincolor?t.config.style.maincolor:"#ff2d4b"}},[a("van-icon",{staticClass:"icon",attrs:{name:"calendar"}}),t._v("\n\t\t\t\t"+t._s(t.year)+"年"+t._s(t.month)+"月\n\t\t\t")],1),t._v(" "),a("div",{staticClass:"calendar-inner"},t._l(t.calendar,function(s){return a("div",{staticClass:"week"},[t._l(s,function(s){return[s.today?[a("div",{staticClass:"day",class:{today:s.today},style:{borderColor:t.config.style.maincolor?t.config.style.maincolor:"#ff2d4b"},on:{click:function(a){return t.onDayClick(s.day,s.grant)}}},[a("p",{staticClass:"num"},[t._v(t._s(s.day?s.day:""))]),t._v(" "),a("p",{staticClass:"grant"},[s.grant?a("van-icon",{staticClass:"icon",style:{color:t.config.style.maincolor?t.config.style.maincolor:"#ff2d4b"},attrs:{name:"recharge"}}):t._e(),t._v(t._s(s.grant))],1),t._v(" "),s.title?a("p",{staticClass:"special"},[t._v(t._s(s.title))]):t._e(),t._v(" "),s.signed?[a("van-icon",{class:{sigend:s.signed},style:{color:t.config.style.maincolor?t.config.style.maincolor:"#ff2d4b"},attrs:{name:"check"}})]:t._e()],2)]:[a("div",{staticClass:"day",on:{click:function(a){return t.onDayClick(s.day,s.grant)}}},[a("p",{staticClass:"num"},[t._v(t._s(s.day?s.day:""))]),t._v(" "),a("p",{staticClass:"grant"},[s.grant?a("van-icon",{staticClass:"icon",style:{color:t.config.style.maincolor?t.config.style.maincolor:"#ff2d4b"},attrs:{name:"recharge"}}):t._e(),t._v(t._s(s.grant))],1),t._v(" "),s.title?a("p",{staticClass:"special"},[t._v(t._s(s.title))]):t._e(),t._v(" "),s.signed?[a("van-icon",{class:{sigend:s.signed},style:{color:t.config.style.maincolor?t.config.style.maincolor:"#ff2d4b"},attrs:{name:"check"}})]:t._e()],2)]]})],2)}),0)]),t._v(" "),t.config.reward.continue.length>0?a("div",{staticClass:"reward-container"},[a("div",{staticClass:"titles"},[a("span",{staticClass:"text"},[a("van-icon",{staticClass:"icon",attrs:{name:"gifts"}}),t._v(" 连续"+t._s(t.config.text.sign)+"有礼")],1),t._v(" "),a("span",{staticClass:"subtitle pull-right"},[t._v("连续"+t._s(t.config.text.sign)+"即可领取")])]),t._v(" "),a("div",{staticClass:"reward-inner"},[a("div",{staticClass:"award"},[a("div",{staticClass:"award-list"},t._l(t.config.reward.continue,function(s,i){return a("div",{staticClass:"item",class:{active:t.continuous_get[s.day]}},[a("div",{staticClass:"grant"},[t._v("+"+t._s(s.credit)),a("br"),t._v(t._s(t.grantType))]),t._v(" "),t.continuous_get[s.day]?[a("div",{staticClass:"circle",class:{active:2==s.status},style:{backgroundColor:t.config.style.maincolor?t.config.style.maincolor:"#ff2d4b"}},[a("i",{staticClass:"icon icon-check"})]),t._v(" "),a("div",{staticClass:"days",style:{color:t.config.style.maincolor?t.config.style.maincolor:"#ff2d4b"}},[t._v(t._s(s.day)+"天")])]:[a("div",{staticClass:"circle",class:{active:2==s.status}},[a("i",{staticClass:"icon icon-check"})]),t._v(" "),a("div",{staticClass:"days"},[t._v(t._s(s.day)+"天")])],t._v(" "),s.status?t._e():a("div",{staticClass:"text",on:{click:function(s){return t.onGetReward()}}},[t._v("不可领")]),t._v(" "),1==s.status?a("div",{staticClass:"text",on:{click:function(a){return t.onGetReward(1,s.day,s.status,i)}}},[t._v("可领取")]):t._e(),t._v(" "),2==s.status?a("div",{staticClass:"text",style:{color:t.config.style.maincolor?t.config.style.maincolor:"#ff2d4b",borderColor:t.config.style.maincolor?t.config.style.maincolor:"#ff2d4b"},on:{click:function(a){return t.onGetReward(1,s.day,s.status,i)}}},[t._v("已领取")]):t._e()],2)}),0)])])]):t._e(),t._v(" "),t.config.reward.total.length>0?a("div",{staticClass:"reward-container"},[a("div",{staticClass:"titles"},[a("span",{staticClass:"text"},[a("van-icon",{staticClass:"icon",attrs:{name:"gifts"}}),t._v(" 累计"+t._s(t.config.text.sign)+"有礼")],1),t._v(" "),a("span",{staticClass:"subtitle pull-right"},[t._v("累计"+t._s(t.config.text.sign)+"满足即可领取")])]),t._v(" "),a("div",{staticClass:"reward-inner"},[a("div",{staticClass:"award"},[a("div",{staticClass:"award-list"},t._l(t.config.reward.total,function(s,i){return a("div",{staticClass:"item",class:{active:t.all_get[s.day]}},[a("div",{staticClass:"grant"},[t._v("+"+t._s(s.credit)),a("br"),t._v(t._s(t.grantType))]),t._v(" "),t.all_get[s.day]?[a("div",{staticClass:"circle",class:{active:2==s.status},style:{backgroundColor:t.config.style.maincolor?t.config.style.maincolor:"#ff2d4b"}},[a("i",{staticClass:"icon icon-check"})]),t._v(" "),a("div",{staticClass:"days",style:{color:t.config.style.maincolor?t.config.style.maincolor:"#ff2d4b"}},[t._v(t._s(s.day)+"天")])]:[a("div",{staticClass:"circle",class:{active:2==s.status}},[a("i",{staticClass:"icon icon-check"})]),t._v(" "),a("div",{staticClass:"days"},[t._v(t._s(s.day)+"天")])],t._v(" "),s.status?t._e():a("div",{staticClass:"text",on:{click:function(s){return t.onGetReward()}}},[t._v("不可领")]),t._v(" "),1==s.status?a("div",{staticClass:"text",on:{click:function(a){return t.onGetReward(2,s.day,s.status,i)}}},[t._v("可领取")]):t._e(),t._v(" "),2==s.status?a("div",{staticClass:"text",style:{color:t.config.style.maincolor?t.config.style.maincolor:"#ff2d4b",borderColor:t.config.style.maincolor?t.config.style.maincolor:"#ff2d4b"},on:{click:function(a){return t.onGetReward(2,s.day,s.status,i)}}},[t._v("已领取")]):t._e()],2)}),0)])])]):t._e()]),t._v(" "),a("van-popup",{staticClass:"agreement-popup",attrs:{position:"bottom"},model:{value:t.agreementShow,callback:function(s){t.agreementShow=s},expression:"agreementShow"}},[a("van-nav-bar",{staticClass:"border-0px",style:{background:t.config.style.maincolor?t.config.style.maincolor:"#ff2d4b",color:"#fff"},attrs:{title:"规则详解"},on:{"click-left":function(s){t.agreementShow=!1}}},[a("van-icon",{staticClass:"font-20",style:{color:"#fff"},attrs:{slot:"left",name:"left"},slot:"left"})],1),t._v(" "),a("div",{staticClass:"popup-content margin-10",domProps:{innerHTML:t._s(t.config.agreement)}})],1)],1)},staticRenderFns:[]};var c=a("VU/8")(n,o,!1,function(t){a("r7eq")},null,null);s.default=c.exports},r7eq:function(t,s){}});
//# sourceMappingURL=259.9441b49a029635534463.js.map