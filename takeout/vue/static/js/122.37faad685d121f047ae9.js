webpackJsonp([122],{"0wiy":function(t,s,i){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var n=i("Gu7T"),a=i.n(n),e=i("mzkE"),o=i("Cz8s"),r=(i("KgXo"),i("NPH5")),d=i("rniE"),l=i("Fd2+"),c={components:{PublicHeader:o.a,PublicFooter:e.a,load:r.a,OrderStatusWarpper:d.a,Dialog:l.a},data:function(){return{status:0,orders:{min:0,finished:!1,loading:!1,data:[]},config_mall:{},errander_status:!1,showPreLoading:!0,menufooter:{},order_remind:{}}},methods:{onChangeOrderStatus:function(t,s){this.status=t,this.onLoad(!0)},onChangeStatus:function(t,s){if("cancel"==s)var i={url:"wmall/order/index/cancel?id="+t,confirm:"确定取消订单吗?"};else if("end_1"==s||"end_2"==s){i={url:"wmall/order/index/end?id="+t,confirm:"你确定收到该商家的外卖?",successUrl:"/pages/order/comment?id="+t};"end_2"==s&&(i.confirm="你确定收到该商家的外卖?")}else if("remind"==s)i={url:"wmall/order/index/remind?id="+t};this.util.jspost(i)},onFinishMealPay:function(){l.a.confirm({title:"温馨提示",message:"您的支付方式为餐后支付，请到商家收银台付款"}).then(function(){})},onLoad:function(t){var s=this;if(!0===t&&(this.orders={min:0,finished:!1,loading:!1,data:[]}),this.orders.finished)return!1;this.util.request({url:"wmall/order/index",data:{status:this.status,min:this.orders.min,menufooter:1,order_remind:1}}).then(function(t){var i=t.data.message;i.errno?s.$toast(i.message):(s.hideLoading(),s.orders.data=[].concat(a()(s.orders.data),a()(i.message)),s.orders.loading=!1,s.orders.min=i.min,s.config_mall=i.config_mall,s.errander_status=i.errander_status,(i.message.length<20||!i.min)&&(s.orders.finished=!0),s.menufooter=window.menufooter,s.order_remind=window.order)})},hideLoading:function(){this.showPreLoading=!1}},mounted:function(){this.util.jsauth(),this.onLoad()}},u={render:function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",{attrs:{id:"order-home"}},[i("public-header",{attrs:{title:"我的订单"}}),t._v(" "),t.order_remind&&t.order_remind.log?i("order-status-warpper",{attrs:{order:t.order_remind}}):t._e(),t._v(" "),i("public-footer",{attrs:{preLoading:t.showPreLoading,menufooter:t.menufooter}}),t._v(" "),i("div",{staticClass:"content"},[t.errander_status?i("div",{staticClass:"paotui",on:{click:function(s){return t.util.jsUrl("/plugin/pages/paotui/order")}}},[t._m(0),t._v(" "),i("div",{staticClass:"headline"},[t._v("万能跑腿订单")]),t._v(" "),i("div",{staticClass:"icon icon-right font-12 c-gray"})]):t._e(),t._v(" "),i("van-list",{attrs:{finished:t.orders.finished,offset:100,"immediate-check":!1},on:{load:t.onLoad},model:{value:t.orders.loading,callback:function(s){t.$set(t.orders,"loading",s)},expression:"orders.loading"}},[t.orders.data.length>0?[t._l(t.orders.data,function(s,n){return i("div",{key:n,staticClass:"order-container"},[i("van-row",{staticClass:"top"},[i("van-col",{attrs:{span:"3"}},[i("div",{staticClass:"logo",on:{click:function(i){return t.util.jsUrl("/pages/store/goods",{sid:s.sid})}}},[i("img",{attrs:{src:s.logo,alt:""}})])]),t._v(" "),i("van-col",{staticClass:"store",attrs:{span:"15"}},[i("div",{staticClass:"store-title",on:{click:function(i){return t.util.jsUrl("/pages/store/goods",{sid:s.sid})}}},[t._v("\n\t\t\t\t\t\t\t\t"+t._s(s.title)+"\n\t\t\t\t\t\t\t\t"),i("span",{staticClass:"icon icon-right font-12 c-gray"})]),t._v(" "),s.discounts.length>0?i("div",{staticClass:"activity"},t._l(s.discounts,function(s,n){return i("div",{key:n,staticClass:"activity-item"},[t._v(t._s(s.title))])}),0):t._e()]),t._v(" "),i("van-col",{staticClass:"status-cn",attrs:{span:"6"}},[t._v(t._s(s.status_text))])],1),t._v(" "),i("div",{staticClass:"goods",on:{click:function(i){return t.util.jsUrl("/pages/order/detail",{id:s.id})}}},[i("div",{staticClass:"goods-list"},t._l(s.goodsArr,function(s,n){return i("div",{staticClass:"goods-item",on:{touchstart:function(t){t.stopPropagation()},touchend:function(t){t.stopPropagation()}}},[i("div",{staticClass:"thumb"},[i("img",{staticClass:"img-100",attrs:{src:s.thumb,alt:""}})]),t._v(" "),i("div",{staticClass:"goods-title"},[t._v(t._s(s.goods_title))])])}),0),t._v(" "),i("div",{staticClass:"goods-total"},[i("div",[i("span",{staticClass:"font-12"},[t._v("\n\t\t\t\t\t\t\t\t"+t._s(t.Lang.dollarSign))]),i("span",{staticClass:"font-bold"},[t._v(t._s(s.final_fee))])]),t._v(" "),i("div",{staticClass:"order-num"},[t._v("共"+t._s(s.num)+"件")])])]),t._v(" "),i("div",{staticClass:"btn-groups"},[0==s.is_pay&&s.status<5?[3==s.order_type&&"finishMeal"==s.pay_type?i("van-button",{attrs:{size:"small",plain:""},on:{click:t.onFinishMealPay}},[t._v("立即支付")]):i("van-button",{attrs:{size:"small",plain:""},on:{click:function(i){return t.util.jsUrl("/pages/public/pay",{order_id:s.id,order_type:"takeout"})}}},[t._v("立即支付")]),t._v(" "),3==s.order_type?i("van-button",{attrs:{type:"default",size:"small",plain:""},on:{click:function(i){return t.util.jsUrl("/tangshi/pages/table/goods",{order_id:s.id,table_id:s.table_id,sid:s.sid})}}},[t._v("加菜")]):t._e()]:t._e(),t._v(" "),1==s.status?[i("van-button",{attrs:{size:"small",plain:""},on:{click:function(i){return t.onChangeStatus(s.id,"cancel")}}},[t._v("取消订单")]),t._v(" "),1==s.is_pay?i("van-button",{attrs:{type:"default",size:"small",plain:""},on:{click:function(i){return t.onChangeStatus(s.id,"remind")}}},[t._v("催单")]):t._e()]:s.status>1&&s.status<5?[1==s.customer_cancel_status?i("van-button",{attrs:{size:"small",plain:""},on:{click:function(i){return t.onChangeStatus(s.id,"cancel")}}},[t._v("取消订单")]):t._e(),t._v(" "),1==s.order_type&&4==s.status?i("van-button",{attrs:{size:"small",plain:""},on:{click:function(i){return t.onChangeStatus(s.id,"end_1")}}},[t._v("确认送达")]):2==s.order_type?i("van-button",{attrs:{size:"small",plain:""},on:{click:function(i){return t.onChangeStatus(s.id,"end_2")}}},[t._v("我已提货")]):t._e(),t._v(" "),1==s.is_pay?i("van-button",{attrs:{type:"default",size:"small",plain:""},on:{click:function(i){return t.onChangeStatus(s.id,"remind")}}},[t._v("催单")]):t._e(),t._v(" "),3==s.order_type&&1==s.is_pay&&"finishMeal"==s.pay_type?i("van-button",{attrs:{type:"default",size:"small",plain:""},on:{click:function(i){return t.util.jsUrl("/tangshi/pages/table/goods",{order_id:s.id,table_id:s.table_id,sid:s.sid})}}},[t._v("加菜")]):t._e()]:5==s.status?[i("van-button",{attrs:{size:"small",plain:"",color:"#ff2d4b"},on:{click:function(i){return t.util.jsUrl("/pages/store/goods",{sid:s.sid,order_id:s.id})}}},[t._v("再来一单")]),t._v(" "),0==s.is_comment?i("van-button",{attrs:{size:"small",plain:""},on:{click:function(i){return t.util.jsUrl("/pages/order/comment",{id:s.id})}}},[t._v(t._s(s.comment_cn))]):t._e(),t._v(" "),t._e()]:6==s.status?[i("van-button",{attrs:{size:"small",plain:"",color:"#ff2d4b"},on:{click:function(i){return t.util.jsUrl("/pages/store/goods",{sid:s.sid,order_id:s.id})}}},[t._v("再来一单")])]:t._e(),t._v(" "),1==s.is_refund?i("van-button",{attrs:{size:"small",plain:""},on:{click:function(i){return t.util.jsUrl("/pages/order/detail",{id:s.id})}}},[t._v("查看退款")]):t._e()],2)],1)}),t._v(" "),t.orders.finished?i("load",{attrs:{type:"loaded",text:"我是有底线的",bgcolor:"#f5f5f5"}}):t._e()]:i("van-empty",{attrs:{description:"您还没有订单，赶紧点一份！"}},[i("van-button",{staticClass:"bottom-button",attrs:{round:"",type:"danger"},on:{click:function(s){return t.util.jsUrl("/pages/home/index")}}},[t._v("\n\t\t\t\t\t现在点一份\n\t\t\t\t")])],1)],2)],1)],1)},staticRenderFns:[function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"image"},[s("img",{staticClass:"img-100",attrs:{src:"static/img/suiyigou_icon.png"}})])}]};var _=i("VU/8")(c,u,!1,function(t){i("738c")},null,null);s.default=_.exports},"738c":function(t,s){}});
//# sourceMappingURL=122.37faad685d121f047ae9.js.map