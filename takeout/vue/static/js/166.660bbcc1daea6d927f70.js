webpackJsonp([166],{"9uqi":function(t,e){},rxoa:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("woOf"),i=s.n(a),r=s("Gu7T"),o=s.n(r),n=s("Cz8s"),l=s("mzkE"),c=s("5ryX"),d=s("Fd2+"),v=s("MJLE"),_=s.n(v),p=s("Yo4o"),m=s("nIsk"),u={components:{PublicHeader:n.a,PublicFooter:l.a,navigator:c.a,Dialog:d.a},data:function(){return{showPreLoading:!0,active_tab:2,goods:[],store:{cn:{}},order:{},activityed:[],deliveryer:{},logs:[],log:{},maxid:"",slides:[],refundmaxid:"",share:{info:{}},refund:{},refund_logs:{},can_delete:0,menufooter:{},sendRedpacket:!1,zhezhaoShow:!1,orderShare:!1,show_location:0,showSelectCall:!1,config_mall:{call_deliveryer_need_select:0,mobile:""},member:{},scrollTop:0,showMap:!1,showYinsihao:!1,yinsihao:{secret_mobile:"",extension:""},servicePopupStatus:!1,deliveryerMarkers:[],memberMarkers:[],storeMarkers:[],MapType:"gaode",back:!1,popup:{log:!1}}},methods:{onTogglePopup:function(t){this.popup[t]=!this.popup[t]},onBack:function(){this.back&&this.$router.back(-1)},onRefresh:function(){window.location.reload()},onChangeStatus:function(t,e,s){if("cancel"==e)var a={url:"wmall/order/index/cancel?id="+t,confirm:"确定取消订单吗?"};else if("end_1"==e||"end_2"==e){a={url:"wmall/order/index/end?id="+t,confirm:"你确定收到该商家的外卖?",successUrl:"/pages/order/comment?id="+t};"end_2"==e&&(a.confirm="你确定收到该商家的外卖?")}else if("remind"==e)a={url:"wmall/order/index/remind?id="+t};this.util.jspost(a)},onFinishMealPay:function(){d.a.confirm({title:"温馨提示",message:"您的支付方式为餐后支付，请到商家收银台付款"}).then(function(){})},onCallStoreOrDeliveryer:function(t){var e=this,s=this;if(1==s.order.data.yinsihao_status)s.util.request({url:"yinsihao/yinsihao",data:{order_id:s.order.id,type:t,ordersn:s.order.ordersn}}).then(function(a){var i=a.data.message;if(i.errno)if(-1e3==i.errno){var r="";"store"==t?r=s.store.telephone:"deliveryer"==t&&(r=s.deliveryer.mobile),s.util.jsTel(r)}else-2==i.errno?s.servicePopupStatus=!0:e.$toast(i.message);else i=i.message,s.yinsihao.secret_mobile=i.data.secret_mobile,s.yinsihao.extension=i.data.extension,s.showYinsihao=!0});else{var a="";"store"==t?a=s.store.telephone:"deliveryer"==t&&(a=s.deliveryer.mobile),s.util.jsTel(a)}},onLoad:function(){var t=this;this.$route.query.id?this.id=this.$route.query.id:this.$toast("订单不存在或已删除！"),this.util.request({url:"wmall/order/index/newDetail",data:{id:this.id,menufooter:1}}).then(function(e){t.showPreLoading=!1;var s=e.data.message;if(s.errno)t.$toast(s.message);else if(t.goods=[].concat(o()(t.goods),o()(s.message.goods)),t.store=s.message.store,s.message.order=t.util.df(s.message.order,2),t.order=s.message.order,t.activityed=[].concat(o()(t.activityed),o()(s.message.activityed)),t.deliveryer=s.message.deliveryer,t.logs=[].concat(o()(s.message.order_log.logs)),t.log=s.message.order_log.log,t.maxid=s.message.order_log.maxid,t.slides=0==s.message.slides?s.message.slides:[].concat(o()(t.slides),o()(s.message.slides)),t.share=s.message.share,t.refund=s.message.refund_data.refund,t.refund_logs=s.message.refund_data.refund_logs,t.refundmaxid=s.message.refund_data.refundmaxid,t.can_delete=s.message.can_delete,t.show_location=s.message.show_location,t.config_mall=s.message.config_mall,t.MapType=t.util.getStorage("MapType"),t.menufooter=window.menufooter,2==t.order.order_type&&s.message.qrcode&&t.$nextTick(function(){this.newQrcode(s.message.qrcode)}),t.member=s.message.member,1==t.show_location&&(t.showMap=!0,t.loadmap(),setInterval(function(){t.onRefreshMap()},1e4),t.checkContentDivScroll()),t.share.info&&(t.share.info.share_button>0||1==t.share.info.superRedpacket_share_status)){var a=window._share,i=t;2==i.share.info.share_button&&(a.success=function(){i.util.request({url:"ordergrant/share/grant",data:{id:i.order.id}}).then(function(t){i.util.$toast(t.data.message.message.message,i.util.getUrl({path:"pages/order/detail",query:{id:i.order.id}}),1e3)})}),i.wx.share(a)}})},onChangeZhezhao:function(t){t&&(this.orderShare=!1,this.sendRedpacket=!1),this.zhezhaoShow=!this.zhezhaoShow},onDeleteOrder:function(){var t=this,e=this;e.$dialog.confirm({message:"确订删除该订单吗？"}).then(function(){e.util.request({url:"wmall/order/index/delete",data:{id:e.order.id}}).then(function(s){var a=s.data.message;a.errno?t.$toast(a.message):e.util.$toast(a.message,e.util.getUrl({path:"/pages/order/index"}),1500,"replace")})}).catch(function(){})},onSelectCall:function(t){t&&this.util.jsTel(t),this.showSelectCall=!this.showSelectCall},newQrcode:function(t){new _.a("qrcode",{width:150,height:150,text:t,image:""})},loadmap:function(){var t=this;"google"==t.MapType?Object(m.a)().then(function(e){t.map=new e.maps.Map(document.getElementById("map-container"),{center:{lat:parseFloat(t.order.location_x),lng:parseFloat(t.order.location_y)},zoom:10,disableDefaultUI:!0}),t.onSetMarkers()}):Object(p.a)().then(function(e){t.map=new e.Map("map-container",{resizeEnable:!0,center:[t.order.location_y,t.order.location_x],zoom:10}),t.onSetMarkers()})},onRefreshMap:function(){var t=this,e=this;e.util.request({url:"wmall/order/index/refresh_map",data:{id:e.order.id}}).then(function(s){var a=s.data.message;a.errno?t.$toast(a.message):(a=a.message,e.order=i()(e.order,a.order),a.deliveryer&&(e.deliveryer=i()(e.deliveryer,a.deliveryer)),e.show_location=a.show_location,e.onSetMarkers())})},onSetMarkers:function(){var t=this;if("google"==t.MapType){var e;if(t.order.location_y&&t.order.location_x){var s=function(t,e){this.bounds_=t,this.map_=e,this.div_=null,this.setMap(e)};t.memberOverlay&&t.memberOverlay.setMap(null),(s.prototype=new google.maps.OverlayView).onRemove=function(){this.div_.parentNode.removeChild(this.div_),this.div_=null},s.prototype.onAdd=function(){var e=document.createElement("div");if(0==t.order.is_pay){e.className="marker-common marker-common-gmap marker-mine-nopay";var s=document.createElement("div");s.className="img-wrap";var a=document.createElement("img");a.src=t.member.avatar,a.className="img-100",s.appendChild(a),e.appendChild(s);var i=document.createElement("div"),r=document.createElement("div");r.className="font-12",r.innerHTML="等待支付",i.appendChild(r),e.appendChild(i)}else e.className="marker-mine-route";this.div_=e,this.getPanes().overlayLayer.appendChild(e)},s.prototype.draw=function(){var e=this.getProjection(),s=e.fromLatLngToDivPixel(this.bounds_.getSouthWest()),a=e.fromLatLngToDivPixel(this.bounds_.getNorthEast()),i=this.div_;0==t.order.is_pay?(i.style.left=s.x-50+"px",i.style.top=a.y-50+"px"):(i.style.left=s.x-35+"px",i.style.top=a.y-35+"px")},e=new google.maps.LatLngBounds(new google.maps.LatLng(parseFloat(t.order.location_x),parseFloat(t.order.location_y))),t.memberOverlay=new s(e,t.map)}if(1==t.order.is_pay&&t.store.location_y&&t.store.location_x){var a=function(t,e){this.bounds_=t,this.map_=e,this.div_=null,this.setMap(e)};t.storeOverlay&&t.storeOverlay.setMap(null),(a.prototype=new google.maps.OverlayView).onRemove=function(){this.div_.parentNode.removeChild(this.div_),this.div_=null},a.prototype.onAdd=function(){var e=document.createElement("div");if(1==t.order.status){e.className="marker-common marker-common-gmap marker-store-waiting";var s=document.createElement("div");s.className="img-wrap",(r=document.createElement("img")).src=t.store.logo,r.className="img-100",s.appendChild(r),e.appendChild(s);var a=document.createElement("div"),i=document.createElement("div");i.className="font-12",i.innerHTML="等待商家接单",a.appendChild(i),e.appendChild(a),o=-62.5,n=-44}else{var r;e.className="marker-start-head-route",(r=document.createElement("img")).src=t.store.logo,e.appendChild(r)}this.div_=e,this.getPanes().overlayLayer.appendChild(e)},a.prototype.draw=function(){var e=this.getProjection(),s=e.fromLatLngToDivPixel(this.bounds_.getSouthWest()),a=e.fromLatLngToDivPixel(this.bounds_.getNorthEast()),i=this.div_;1==t.order.status?(i.style.left=s.x-62.5+"px",i.style.top=a.y-115+"px"):(i.style.left=s.x-35+"px",i.style.top=a.y-140+"px")},e=new google.maps.LatLngBounds(new google.maps.LatLng(parseFloat(t.store.location_x),parseFloat(t.store.location_y))),t.storeOverlay=new a(e,t.map)}if(t.order.deliveryer_id>0&&t.deliveryer&&t.deliveryer.location_x&&t.deliveryer.location_y){var i=function(t,e){this.bounds_=t,this.map_=e,this.div_=null,this.setMap(e)};t.deliveryerOverlay&&t.deliveryerOverlay.setMap(null),(i.prototype=new google.maps.OverlayView).onRemove=function(){this.div_.parentNode.removeChild(this.div_),this.div_=null},i.prototype.onAdd=function(){var e=document.createElement("div");e.className="marker-common marker-common-gmap marker-deliveryer-take";var s=document.createElement("div");s.className="img-wrap";var a=document.createElement("img");a.src=t.deliveryer.avatar,a.className="img-100",s.appendChild(a),e.appendChild(s);var i=document.createElement("div"),r=document.createElement("div");r.className="font-12",r.innerHTML=7==t.order.delivery_status?"骑手正在赶往商家":"骑手正在送餐中",i.appendChild(r),e.appendChild(i),this.div_=e,this.getPanes().overlayLayer.appendChild(e)},i.prototype.draw=function(){var t=this.getProjection(),e=t.fromLatLngToDivPixel(this.bounds_.getSouthWest()),s=t.fromLatLngToDivPixel(this.bounds_.getNorthEast()),a=this.div_;a.style.left=e.x-85+"px",a.style.top=s.y-190+"px"},e=new google.maps.LatLngBounds(new google.maps.LatLng(parseFloat(t.deliveryer.location_x),parseFloat(t.deliveryer.location_y))),t.deliveryerOverlay=new i(e,t.map)}}else{var r="",o="",n="";if(t.order.location_y&&t.order.location_x){t.map.remove(t.memberMarkers),r='<div class="marker-mine-route"></div>',o=-35,n=-35,0==t.order.is_pay&&(r='<div class="marker-common marker-mine-nopay"><div class="img-wrap"><img class="img-100" src="'+t.member.avatar+'" alt=""></div><div class=""><div class="font-12 ">等待支付</div></div>',o=-50,n=-44);var l=new AMap.Marker({position:[t.order.location_y,t.order.location_x],offset:new AMap.Pixel(o,n),content:r});t.memberMarkers.push(l),l.setMap(t.map)}if(1==t.order.is_pay&&t.store.location_y&&t.store.location_x){t.map.remove(t.storeMarkers),r='<div class="marker-start-head-route"><img src="'+t.store.logo+'" alt=""/></div>',o=-33,n=-80,1==t.order.status&&(r='<div class="marker-common marker-store-waiting"><div class="img-wrap"><img class="img-100" src="'+t.store.logo+'" alt=""></div><div class=""><div class="font-12 ">等待商家接单</div></div>',o=-62.5,n=-44);l=new AMap.Marker({position:[t.store.location_y,t.store.location_x],offset:new AMap.Pixel(o,n),content:r});t.storeMarkers.push(l),l.setMap(t.map)}if(t.order.deliveryer_id>0&&t.deliveryer&&t.deliveryer.location_x&&t.deliveryer.location_y){t.map.remove(t.deliveryerMarkers),7==t.order.delivery_status?(r='<div class="marker-common marker-deliveryer-take"><div class="img-wrap"><img class="img-100" src="'+t.deliveryer.avatar+'" alt=""></div><div class=""><div class="font-12 ">骑手正在赶往商家</div><div class="font-12 hide">距商家 <span class="c-danger">1.6km 18分钟</span></div> </div>',o=-85,n=-44):4==t.order.delivery_status&&(r='<div class="marker-common marker-deliveryer-take"><div class="img-wrap"><img class="img-100" src="'+t.deliveryer.avatar+'" alt=""></div><div class=""><div class="font-12 ">骑手正在送餐中</div><div class="font-12 hide">预计<span class="c-danger">18</span>分钟送达</span></div> </div>',o=-85,n=-44);l=new AMap.Marker({position:[t.deliveryer.location_y,t.deliveryer.location_x],offset:new AMap.Pixel(o,n),content:r});t.deliveryerMarkers.push(l),l.setMap(t.map)}t.map.setFitView()}},checkContentDivScroll:function(){var t=this,e=document.getElementById("scrollDiv");e.addEventListener("scroll",function(){var s=e.scrollTop-t.scrollTop;t.scrollTop=e.scrollTop,s<0?t.scrollTop<=0&&!t.showMap&&(t.showMap=!0):t.scrollTop>0&&t.showMap&&(t.showMap=!1,t.scrollTop=0,t.$nextTicket(function(){t.$refs.scrollDiv.scrollTop=0,e.scrollTop=0}))})}},computed:{offsetTop:function(){var t=this.util.getStorage("theme"),e=46;return t.header&&1==t.header.ishide&&(e=0),e}},mounted:function(){window.history.length>1&&(this.back=!0),this.onLoad()}},g={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"new-detail"}},[s("div",{staticClass:"top"},[s("div",[t.back?s("div",{staticClass:"icon icon-left",on:{click:t.onBack}}):t._e()]),t._v(" "),s("div",{staticClass:"flex"},[s("div",{staticClass:"icon-wrap",on:{click:t.onRefresh}},[s("div",{staticClass:"icon icon-refresh font-14"}),t._v(" "),s("div",{staticClass:"font-12 font-500"},[t._v("刷新")])]),t._v(" "),s("div",{staticClass:"icon-wrap",on:{click:function(e){return t.util.jsUrl("/plugin/pages/kefu/chat",{relation:"member2kefu"})}}},[s("div",{staticClass:"icon icon-service font-18"}),t._v(" "),s("div",{staticClass:"font-12 font-500"},[t._v("客服")])])])]),t._v(" "),s("div",{class:{"status-title":1,show:!t.showMap},on:{click:function(e){return t.onTogglePopup("log")}}},[s("div",{staticClass:"font-500 margin-10-r"},[t._v("订单"+t._s(t.order.status_cn))]),t._v(" "),s("div",{staticClass:"icon icon-right font-12 c-gray"})]),t._v(" "),s("public-footer",{attrs:{preLoading:t.showPreLoading,menufooter:t.menufooter}}),t._v(" "),s("div",{staticClass:"content font-14"},[s("div",{ref:"scrollDiv",class:{inner:1,sticky:!t.showMap},attrs:{id:"scrollDiv"}},[t._e(),t._v(" "),s("div",{staticClass:"block order-status"},[s("div",{staticClass:"padding-15-b",on:{click:function(e){return t.onTogglePopup("log")}}},[s("div",{staticClass:"font-14 font-500"},[t._v("订单"+t._s(t.order.status_cn))]),t._v(" "),t.log&&7!=t.order.delivery_status?s("div",{staticClass:"font-12 c-gray margin-5-t"},[t._v(t._s(t.log.note))]):t._e()]),t._v(" "),s("div",{staticClass:"btn-group van-hairline--top"},[0==t.order.is_pay&&t.order.status<5?[3==t.order.order_type&&"finishMeal"==t.order.pay_type?s("div",{staticClass:"btn-item active",on:{click:t.onFinishMealPay}},[s("div",{staticClass:"icon icon-moneybagfill"}),t._v(" "),s("div",{staticClass:"margin-5-t"},[t._v("立即支付")])]):s("div",{staticClass:"btn-item active",on:{click:function(e){return t.util.jsUrl("/pages/public/pay",{order_id:t.order.id,order_type:"takeout"})}}},[s("div",{staticClass:"icon icon-moneybagfill"}),t._v(" "),s("div",{staticClass:"margin-5-t"},[t._v("立即支付")])]),t._v(" "),3==t.order.order_type?s("div",{staticClass:"btn-item",on:{click:function(e){return t.util.jsUrl("/tangshi/pages/table/goods",{order_id:t.order.id,table_id:t.order.table_id,sid:t.order.sid})}}},[s("div",{staticClass:"icon icon-add2"}),t._v(" "),s("div",{staticClass:"margin-5-t"},[t._v("加菜")])]):t._e(),t._v(" "),1==t.order.order_type&&1==t.order.update_order_info_status?s("div",{staticClass:"btn-item",on:{click:function(e){return t.util.jsUrl("/pages/order/op",{id:t.order.id})}}},[s("div",{staticClass:"icon icon-infofill"}),t._v(" "),s("div",{staticClass:"margin-5-t"},[t._v("修改备注")])]):t._e()]:t._e(),t._v(" "),1==t.order.status?[s("div",{staticClass:"btn-item active",on:{click:function(e){return t.onChangeStatus(t.order.id,"cancel")}}},[s("div",{staticClass:"icon icon-roundclosefill"}),t._v(" "),s("div",{staticClass:"margin-5-t"},[t._v("取消订单")])]),t._v(" "),1==t.order.is_pay?s("div",{staticClass:"btn-item",on:{click:function(e){return t.onChangeStatus(t.order.id,"remind")}}},[s("div",{staticClass:"icon icon-timefill"}),t._v(" "),s("div",{staticClass:"margin-5-t"},[t._v("催单")])]):t._e()]:t.order.status>1&&t.order.status<5?[t.order.customer_cancel_status?s("div",{staticClass:"btn-item active",on:{click:function(e){return t.onChangeStatus(t.order.id,"cancel")}}},[s("div",{staticClass:"icon icon-roundclosefill"}),t._v(" "),s("div",{staticClass:"margin-5-t"},[t._v("取消订单")])]):t._e(),t._v(" "),1==t.order.order_type&&4==t.order.status?s("div",{staticClass:"btn-item",on:{click:function(e){return t.onChangeStatus(t.order.id,"end_1")}}},[s("div",{staticClass:"icon icon-countdownfill"}),t._v(" "),s("div",{staticClass:"margin-5-t"},[t._v("确认送达")])]):2==t.order.order_type?s("div",{staticClass:"btn-item",on:{click:function(e){return t.onChangeStatus(t.order.id,"end_2")}}},[s("div",{staticClass:"icon icon-squarecheckfill"}),t._v(" "),s("div",{staticClass:"margin-5-t"},[t._v("我已提货")])]):t._e(),t._v(" "),1==t.order.is_pay?s("div",{staticClass:"btn-item",on:{click:function(e){return t.onChangeStatus(t.order.id,"remind")}}},[s("div",{staticClass:"icon icon-timefill"}),t._v(" "),s("div",{staticClass:"margin-5-t"},[t._v("催单")])]):t._e(),t._v(" "),3==t.order.order_type&&1==t.order.is_pay&&"finishMeal"==t.order.pay_type?s("div",{staticClass:"btn-item",on:{click:function(e){return t.util.jsUrl("/tangshi/pages/table/goods",{order_id:t.order.id,table_id:t.order.table_id,sid:t.order.sid})}}},[s("div",{staticClass:"icon icon-add2"}),t._v(" "),s("div",{staticClass:"margin-5-t"},[t._v("加菜")])]):t._e()]:5==t.order.status?[t.order.show_deliveryer_award?s("div",{staticClass:"btn-item",on:{click:function(e){return t.util.jsUrl("/pages/order/award",{id:t.order.id})}}},[s("div",{staticClass:"icon icon-moneybagfill"}),t._v(" "),s("div",{staticClass:"margin-5-t"},[t._v("打赏骑手")])]):t._e(),t._v(" "),s("div",{staticClass:"btn-item active",on:{click:function(e){return t.util.jsUrl("/pages/store/goods",{sid:t.order.sid,order_id:t.order.id})}}},[s("div",{staticClass:"icon icon-add2"}),t._v(" "),s("div",{staticClass:"margin-5-t"},[t._v("再来一单")])]),t._v(" "),0==t.order.is_comment?s("div",{staticClass:"btn-item",on:{click:function(e){return t.util.jsUrl("/pages/order/comment",{id:t.order.id})}}},[s("div",{staticClass:"icon icon-commentfill"}),t._v(" "),s("div",{staticClass:"margin-5-t"},[t._v(t._s(t.order.comment_cn))])]):t._e()]:6==t.order.status?[s("div",{staticClass:"btn-item active",on:{click:function(e){return t.util.jsUrl("/pages/store/goods",{sid:t.order.sid,order_id:t.order.id})}}},[s("div",{staticClass:"icon icon-add2"}),t._v(" "),s("div",{staticClass:"margin-5-t"},[t._v("再来一单")])])]:t._e(),t._v(" "),1==t.order.update_address_status?[s("div",{staticClass:"btn-item",on:{click:function(e){return t.util.jsUrl("/pages/order/address",{id:t.order.id})}}},[s("div",{staticClass:"icon icon-friendaddfill"}),t._v(" "),s("div",{staticClass:"margin-5-t"},[t._v("修改地址")])])]:t._e(),t._v(" "),t.order.data&&t.order.data.pindan?[s("div",{staticClass:"btn-item",on:{click:function(e){return t.util.jsUrl("/pages/order/pindanbill",{id:t.order.id})}}},[s("div",{staticClass:"icon icon-friendfill"}),t._v(" "),s("div",{staticClass:"margin-5-t"},[t._v("拼单分账")])])]:t._e(),t._v(" "),1==t.can_delete?s("div",{staticClass:"btn-item active",on:{click:t.onDeleteOrder}},[s("div",{staticClass:"icon icon-deletefill"}),t._v(" "),s("div",{staticClass:"margin-5-t"},[t._v("删除订单")])]):t._e(),t._v(" "),t.order.refund_status>0?s("div",{staticClass:"btn-item",on:{click:function(e){return t.util.jsUrl("/pages/order/refund",{id:t.order.id})}}},[s("div",{staticClass:"icon icon-money"}),t._v(" "),s("div",{staticClass:"margin-5-t"},[t._v("退款详情")])]):t._e()],2)]),t._v(" "),t.slides?s("div",{staticClass:"swiper-container"},[s("van-swipe",{attrs:{autoplay:3e3,"indicator-color":"#ff2d4b"}},t._l(t.slides,function(e,a){return s("van-swipe-item",{key:a},[s("div",{on:{click:function(s){return t.util.jsUrl(e.wxapp_link)}}},[s("img",{attrs:{src:e.thumb}})])])}),1)],1):t._e(),t._v(" "),s("div",{staticClass:"block"},[s("div",{staticClass:"store padding-15-b van-hairline--bottom"},[s("span",{staticClass:"store-title"},[t._v(t._s(t.store.title))]),t._v(" "),s("span",{staticClass:"icon icon-right font-12 c-gray margin-5-l"})]),t._v(" "),s("div",{staticClass:"goods"},t._l(t.goods,function(e,a){return s("van-row",{key:a,staticClass:"goods-item margin-15-tb"},[s("van-col",{attrs:{span:"3"}},[s("div",{staticClass:"thumb"},[s("img",{attrs:{src:e.thumb,alt:""}})])]),t._v(" "),s("van-col",{staticClass:"padding-10-l",attrs:{span:"16"}},[s("div",{staticClass:"w-100 ellipsis"},[t._v(t._s(e.goods_title))]),t._v(" "),s("div",{staticClass:"goods-num"},[t._v("x"+t._s(e.goods_num))])]),t._v(" "),s("van-col",{staticClass:"text-right",attrs:{span:"5"}},[s("span",{staticClass:"font-12"},[t._v(t._s(t.Lang.dollarSign))]),t._v(t._s(e.goods_price)+"\n\t\t\t\t\t\t")])],1)}),1),t._v(" "),s("div",{staticClass:"cost van-hairline--top padding-15-b"},[t.order.box_price>0?s("van-row",{staticClass:"cost-item"},[s("van-col",{attrs:{span:"16"}},[t._v(t._s(3==t.order.order_type?"餐具费":t.store.cn.box_price))]),t._v(" "),s("van-col",{staticClass:"text-right",attrs:{span:"8"}},[s("span",{staticClass:"font-12"},[t._v(t._s(t.Lang.dollarSign))]),t._v(t._s(t.order.box_price))])],1):t._e(),t._v(" "),s("van-row",{staticClass:"cost-item"},[s("van-col",{attrs:{span:"16"}},[t._v(t._s(t.store.cn.pack_fee))]),t._v(" "),s("van-col",{staticClass:"text-right",attrs:{span:"8"}},[s("span",{staticClass:"font-12"},[t._v(t._s(t.Lang.dollarSign))]),t._v(t._s(t.order.pack_fee))])],1),t._v(" "),t.order.person_num>0?s("van-row",{staticClass:"cost-item"},[s("van-col",{attrs:{span:"16"}},[t._v("餐具数量")]),t._v(" "),s("van-col",{staticClass:"text-right",attrs:{span:"8"}},[t._v(t._s(t.order.person_num)+"套")])],1):t._e(),t._v(" "),s("van-row",{staticClass:"cost-item"},[s("van-col",{attrs:{span:"16"}},[t._v("配送费")]),t._v(" "),s("van-col",{staticClass:"text-right",attrs:{span:"8"}},[s("span",{staticClass:"font-12"},[t._v(t._s(t.Lang.dollarSign))]),t._v(t._s(t.order.delivery_fee))])],1),t._v(" "),3==t.order.order_type?s("van-row",{staticClass:"cost-item"},[s("van-col",{attrs:{span:"16"}},[t._v("服务费")]),t._v(" "),s("van-col",{staticClass:"text-right",attrs:{span:"8"}},[s("span",{staticClass:"font-12"},[t._v(t._s(t.Lang.dollarSign))]),t._v(t._s(t.order.serve_fee))])],1):t._e(),t._v(" "),t.order.data?[t._l(t.order.data.extra_fee,function(e,a){return t.order.data.extra_fee.length>0?s("van-row",{key:a,staticClass:"cost-item"},[s("van-col",{attrs:{span:"16"}},[t._v(t._s(e.name))]),t._v(" "),s("van-col",{staticClass:" text-right ",attrs:{span:"8"}},[s("span",{staticClass:"font-12"},[t._v(t._s(t.Lang.dollarSign))]),t._v(t._s(e.fee))])],1):t._e()}),t._v(" "),t._l(t.order.data.store_extra_fee,function(e,a){return t.order.data.store_extra_fee.length>0?s("van-row",{key:"diyFee"+a,staticClass:"cost-item"},[s("van-col",{attrs:{span:"16"}},[t._v(t._s(e.name))]),t._v(" "),s("van-col",{staticClass:" text-right ",attrs:{span:"8"}},[s("span",{staticClass:"font-12"},[t._v(t._s(t.Lang.dollarSign))]),t._v(t._s(e.fee))])],1):t._e()})]:t._e()],2),t._v(" "),t.activityed.length>0?s("div",{staticClass:"activity van-hairline--top padding-15-b"},t._l(t.activityed,function(e,a){return s("van-row",{key:a,staticClass:"activity-item"},[s("van-col",{staticClass:"icon-before",attrs:{span:"2"}},[s("div",{staticClass:"activity-label"},[s("img",{attrs:{src:"static/img/"+e.type+"_b.png",alt:""}})])]),t._v(" "),s("van-col",{attrs:{span:"17"}},[t._v(t._s(e.name))]),t._v(" "),s("van-col",{staticClass:"text-right discount-note",attrs:{span:"5"}},[t._v(t._s(e.note))])],1)}),1):t._e(),t._v(" "),s("div",{staticClass:"fee van-hairline--top"},[s("div",{staticClass:"c-gray"},[t._v("订单")]),t._v(" "),s("div",[s("span",{staticClass:"font-12"},[t._v(t._s(t.Lang.dollarSign))]),s("span",[t._v(t._s(t.order.total_fee))])]),t._v(" "),s("div",{staticClass:"c-gray margin-10-l"},[t._v("优惠")]),t._v(" "),s("div",[s("span",{staticClass:"font-12"},[t._v(t._s(t.Lang.dollarSign))]),s("span",[t._v(t._s(t.order.discount_fee))])]),t._v(" "),s("div",{staticClass:"c-gray margin-10-l"},[t._v("合计")]),t._v(" "),s("div",[s("span",{staticClass:"font-12"},[t._v(t._s(t.Lang.dollarSign))]),s("span",[t._v(t._s(t.order.final_fee))])])]),t._v(" "),s("div",{staticClass:"link van-hairline--top"},[t.order.kefu&&1==t.order.kefu.store_status?s("router-link",{staticClass:"link-item van-hairline--right",attrs:{tag:"div",to:t.util.getUrl({path:"/plugin/pages/kefu/chat",query:{relation:"member2clerk",kefuopenid:t.order.sid,kefuunionid:t.order.sid,orderid:t.order.id}})}},[s("span",{staticClass:"icon icon-wang"}),t._v(" "),s("span",[t._v("联系商家")])]):t._e(),t._v(" "),s("div",{staticClass:"link-item ",on:{click:function(e){return t.onCallStoreOrDeliveryer("store")}}},[s("span",{staticClass:"icon icon-telephone"}),t._v(" "),s("span",[t._v("致电商家")])])],1)]),t._v(" "),t.order.data&&t.order.data.meal_redpacket?s("div",{staticClass:"block"},[s("div",{staticClass:"block-title van-hairline--bottom"},[t._v("套餐红包")]),t._v(" "),s("div",{staticClass:"info"},[s("van-row",{staticClass:"info-item"},[s("van-col",{attrs:{span:"6"}},[t._v("购买费用")]),t._v(" "),s("van-col",{staticClass:"text-right",attrs:{span:"18"}},[s("span",{staticClass:"font-12"},[t._v(t._s(t.Lang.dollarSign))]),t._v(t._s(t.order.data.meal_redpacket.fee)+"\n\t\t\t\t\t\t")])],1)],1)]):t._e(),t._v(" "),2==t.order.order_type?s("div",{staticClass:"block"},[s("div",{staticClass:"block-title van-hairline--bottom"},[t._v("订单核销")]),t._v(" "),s("div",{staticClass:"info"},[s("div",[s("div",{staticClass:"qrcode",attrs:{id:"qrcode"}}),t._v(" "),s("p",{staticClass:"text-center font-12 margin-10-t"},[t._v("核销码: "+t._s(t.order.code))])]),t._v(" "),s("div",{staticClass:"text-center c-gray margin-10-t"},[t._v("请商家扫描二维码或者填写核销码即可消费")])])]):t._e(),t._v(" "),t.order.order_type<=2?s("div",{staticClass:"block"},[s("div",{staticClass:"block-title van-hairline--bottom"},[t._v("配送信息")]),t._v(" "),s("div",{staticClass:"info padding-15-b"},[1==t.order.order_type&&t.order.deliveryer_id>0?[s("van-row",{staticClass:"info-item"},[s("van-col",{attrs:{span:"6"}},[t._v("配送服务")]),t._v(" "),s("van-col",{staticClass:"text-right",attrs:{span:"18"}},[t._v(t._s(t.order.delivery_title))])],1),t._v(" "),s("van-row",{staticClass:"info-item"},[s("van-col",{attrs:{span:"6"}},[t._v("配送骑手")]),t._v(" "),s("van-col",{staticClass:"text-right",attrs:{span:"18"}},[t._v(t._s(t.deliveryer.title))])],1)]:t._e(),t._v(" "),s("van-row",{staticClass:"info-item"},[s("van-col",{attrs:{span:"6"}},[t._v(t._s(1==t.order.order_type?"期望时间":"自提时间"))]),t._v(" "),s("van-col",{staticClass:"text-right",attrs:{span:"18"}},[t._v(t._s(t.order.delivery_day)+"~"+t._s(t.order.delivery_time))])],1),t._v(" "),1==t.order.order_type?[s("van-row",{staticClass:"info-item"},[s("van-col",{attrs:{span:"6"}},[t._v("配送地址")]),t._v(" "),s("van-col",{staticClass:"text-right",attrs:{span:"18"}},[s("div",{staticClass:"margin-5-b"},[t._v(t._s(t.order.username)+" ("+t._s(t.order.sex)+") "+t._s(t.order.mobile))]),t._v("\n\t\t\t\t\t\t\t\t"+t._s(t.order.address)+"\n\t\t\t\t\t\t\t")])],1)]:2==t.order.order_type?[s("van-row",{staticClass:"info-item"},[s("van-col",{attrs:{span:"6"}},[t._v("自提地址")]),t._v(" "),s("van-col",{staticClass:"text-right",attrs:{span:"18"}},[t._v(t._s(t.store.address))])],1)]:t._e(),t._v(" "),t.order.zhunshibao_status>0?s("van-row",{staticClass:"info-item"},[s("van-col",{attrs:{span:"6"}},[t._v("准时宝")]),t._v(" "),s("van-col",{staticClass:"text-right",attrs:{span:"18"}},[s("router-link",{staticClass:"flex",attrs:{tag:"div",to:t.util.getUrl({path:"pages/order/zhunshibao",query:{id:t.order.id}})}},[t._v("\n\t\t\t\t\t\t\t\t准时宝详情\n\t\t\t\t\t\t\t\t"),s("div",{staticClass:"icon icon-right c-gray margin-5-l font-12"})])],1)],1):t._e()],2),t._v(" "),t.order.deliveryer_id>0?s("div",{staticClass:"link van-hairline--top"},[t.order.kefu&&1==t.order.kefu.deliveryer_status&&3!=t.deliveryer.kefu_status?s("router-link",{staticClass:"link-item van-hairline--right",attrs:{tag:"div",to:t.util.getUrl({path:"/plugin/pages/kefu/chat",query:{relation:"member2deliveryer",kefuopenid:t.deliveryer.token,orderid:t.order.id}})}},[s("span",{staticClass:"icon icon-wang"}),t._v(" "),s("span",[t._v("联系骑手")])]):t._e(),t._v(" "),s("div",{staticClass:"link-item ",on:{click:function(e){return t.onCallStoreOrDeliveryer("store")}}},[s("span",{staticClass:"icon icon-telephone"}),t._v(" "),s("span",[t._v("致电骑手")])])],1):t._e()]):t._e(),t._v(" "),s("div",{staticClass:"block"},[s("div",{staticClass:"block-title van-hairline--bottom"},[t._v("订单信息")]),t._v(" "),s("div",{staticClass:"info"},[s("van-row",{staticClass:"info-item"},[s("van-col",{attrs:{span:"6"}},[t._v("商户订单号")]),t._v(" "),s("van-col",{staticClass:"text-right",attrs:{span:"18"}},[t._v("#"+t._s(t.order.serial_sn))])],1),t._v(" "),s("van-row",{staticClass:"info-item"},[s("van-col",{attrs:{span:"6"}},[t._v("平台订单号")]),t._v(" "),s("van-col",{staticClass:"text-right",attrs:{span:"18"}},[t._v(t._s(t.order.ordersn))])],1),t._v(" "),1==t.order.show_code?s("van-row",{staticClass:"info-item"},[s("van-col",{attrs:{span:"6"}},[t._v("取餐码")]),t._v(" "),s("van-col",{staticClass:"text-right",attrs:{span:"18"}},[t._v(t._s(t.order.code))])],1):t._e(),t._v(" "),s("van-row",{staticClass:"info-item"},[s("van-col",{attrs:{span:"6"}},[t._v("订单类型")]),t._v(" "),s("van-col",{staticClass:"text-right",attrs:{span:"18"}},[1==t.order.order_type?[t._v("外卖")]:2==t.order.order_type?[t._v("自提")]:3==t.order.order_type?[t._v("店内")]:4==t.order.order_type?[t._v("预定")]:t._e()],2)],1),t._v(" "),3==t.order.order_type?[s("van-row",{staticClass:"info-item"},[s("van-col",{attrs:{span:"6"}},[t._v("桌台号")]),t._v(" "),s("van-col",{staticClass:"text-right",attrs:{span:"18"}},[t._v(t._s(t.order.table.title))])],1),t._v(" "),s("van-row",{staticClass:"info-item"},[s("van-col",{attrs:{span:"6"}},[t._v("来客人数")]),t._v(" "),s("van-col",{staticClass:"text-right",attrs:{span:"18"}},[t._v("\n\t\t\t\t\t\t\t\t"+t._s(t.order.person_num>0?t.order.person_num:"未知")+"\n\t\t\t\t\t\t\t")])],1)]:t._e(),t._v(" "),4==t.order.order_type?[s("van-row",{staticClass:"info-item"},[s("van-col",{attrs:{span:"6"}},[t._v("预定时间")]),t._v(" "),s("van-col",{staticClass:"text-right",attrs:{span:"18"}},[t._v(t._s(t.order.reserve_time))])],1),t._v(" "),s("van-row",{staticClass:"info-item"},[s("van-col",{attrs:{span:"6"}},[t._v("桌台类型")]),t._v(" "),s("van-col",{staticClass:"text-right",attrs:{span:"18"}},[t._v(t._s(t.order.table_category.title))])],1),t._v(" "),t.order.table_id>0?s("van-row",{staticClass:"info-item"},[s("van-col",{attrs:{span:"6"}},[t._v("预定桌号")]),t._v(" "),s("van-col",{staticClass:"text-right",attrs:{span:"18"}},[t._v(t._s(t.order.table.title))])],1):t._e(),t._v(" "),s("van-row",{staticClass:"info-item"},[s("van-col",{attrs:{span:"6"}},[t._v("预定类型")]),t._v(" "),s("van-col",{staticClass:"text-right",attrs:{span:"18"}},[t._v(t._s(t.order.reserve_type_cn))])],1),t._v(" "),s("van-row",{staticClass:"info-item"},[s("van-col",{attrs:{span:"6"}},[t._v("来客人数")]),t._v(" "),s("van-col",{staticClass:"text-right",attrs:{span:"18"}},[t._v(t._s(t.order.person_num>0?t.order.person_num:"未知"))])],1)]:t._e(),t._v(" "),s("van-row",{staticClass:"info-item"},[s("van-col",{attrs:{span:"6"}},[t._v("支付方式")]),t._v(" "),s("van-col",{staticClass:"text-right",attrs:{span:"18"}},[t._v(t._s(t.order.pay_type_cn))])],1),t._v(" "),s("van-row",{staticClass:"info-item"},[s("van-col",{attrs:{span:"6"}},[t._v("备注信息")]),t._v(" "),s("van-col",{staticClass:"text-right",attrs:{span:"18"}},[t._v(t._s(t.order.note?t.order.note:"无"))])],1),t._v(" "),t.order.invoice?[t.order.invoice.title?s("van-row",{staticClass:"info-item"},[s("van-col",{attrs:{span:"6"}},[t._v("发票抬头")]),t._v(" "),s("van-col",{staticClass:"text-right",attrs:{span:"18"}},[t._v(t._s(t.order.invoice.title))])],1):t._e(),t._v(" "),t.order.invoice.recognition?s("van-row",{staticClass:"info-item"},[s("van-col",{attrs:{span:"6"}},[t._v("纳税人识别号")]),t._v(" "),s("van-col",{staticClass:"text-right",attrs:{span:"18"}},[t._v(t._s(t.order.invoice.recognition))])],1):t._e()]:t._e()],2)])]),t._v(" "),1==t.show_location?s("div",{staticClass:"map-wrap",class:{"map-wrap-hide":!t.showMap}},[s("div",{attrs:{id:"map-container"}})]):t._e()]),t._v(" "),t.share.info.share_button>0?[s("div",{staticClass:"send-redpacket",on:{click:function(e){t.orderShare=!0}}},[t._m(0)]),t._v(" "),s("van-popup",{staticClass:"popup-send-redpacket padding-15-b",attrs:{overlay:!0},model:{value:t.orderShare,callback:function(e){t.orderShare=e},expression:"orderShare"}},[s("div",{staticClass:"popup-content grant-share"},[s("p",{staticClass:"font-20 grant-share-title margin-10-b"},[t._v("分享规则")]),t._v(" "),s("p",{staticClass:"font-15"},[t._v("1. 顾客在订单完成后"+t._s(t.share.share_grant_days_limit)+"天之内，对订单进行评价并分享到朋友圈即可获取"+t._s(t.share.share_grant)+t._s(t.share.grantType_cn))]),t._v(" "),s("p",{staticClass:"font-15 margin-10-t"},[t._v("2. 每人通过分享订单最多可获取"+t._s(t.share.share_grant_max)+t._s(t.share.grantType_cn)+"，超出后将不再奖励")])]),t._v(" "),s("div",{staticClass:"popup-footer"},[s("div",{staticClass:"grant-share-btn"},[1==t.share.info.share_button?s("router-link",{staticClass:"btn bg-danger",attrs:{tag:"div",to:t.util.getUrl({path:"pages/order/comment",query:{id:t.order.id}})}},[t._v("现在去评价")]):s("div",{staticClass:"btn bg-danger",on:{click:function(e){return t.onChangeZhezhao(!0)}}},[t._v("您已评价,去分享")])],1)])])]:t._e(),t._v(" "),1==t.share.info.superRedpacket_share_status?[s("div",{staticClass:"send-redpacket",on:{click:function(e){t.sendRedpacket=!0}}},[s("img",{attrs:{src:"static/img/send-redpacket.png",alt:""}})]),t._v(" "),s("van-popup",{staticClass:"popup-send-redpacket",attrs:{overlay:!0},model:{value:t.sendRedpacket,callback:function(e){t.sendRedpacket=e},expression:"sendRedpacket"}},[s("div",{staticClass:"popup-content border-1px-b"},[s("img",{attrs:{src:"static/img/wv.png",alt:""}}),t._v(" "),s("p",{staticClass:"font-15 font-bold"},[t._v("恭喜获得"+t._s(t.share.info.superRedpacket.packet_total)+"个红包")]),t._v(" "),s("p",{staticClass:"font-14 margin-10-t"},[t._v("分享给小伙伴，大家一起抢。")])]),t._v(" "),s("div",{staticClass:"popup-footer flex-lr"},[s("div",{staticClass:"cancle border-1px-r",on:{click:function(e){t.sendRedpacket=!1}}},[t._v("取消")]),t._v(" "),s("div",{staticClass:"grant",on:{click:function(e){return t.onChangeZhezhao(!0)}}},[t._v("发红包")])])])]:t._e(),t._v(" "),t.zhezhaoShow?s("div",{staticClass:"share-zhezhao",on:{click:function(e){return t.onChangeZhezhao()}}},[s("img",{attrs:{src:"static/img/share-layer.png",alt:""}})]):t._e(),t._v(" "),s("van-popup",{staticClass:"call-phone",model:{value:t.showSelectCall,callback:function(e){t.showSelectCall=e},expression:"showSelectCall"}},[s("div",{staticClass:"call-phone-header"},[t._v("请选择联系人")]),t._v(" "),s("div",{staticClass:"call-plateform",on:{click:function(e){return t.onSelectCall(t.config_mall.mobile)}}},[s("div",[t._v("联系平台(推荐)")])]),t._v(" "),s("div",{staticClass:"call-deliveryer van-hairline--top",on:{click:function(e){return t.onSelectCall(t.deliveryer.mobile)}}},[s("div",[t._v("联系配送员")])])]),t._v(" "),s("van-popup",{staticClass:"yinsihao-popup",model:{value:t.showYinsihao,callback:function(e){t.showYinsihao=e},expression:"showYinsihao"}},[s("div",{staticClass:"popup-title"},[s("img",{staticClass:"yinsihao-img",attrs:{src:"static/img/yinsihao_bg.png",alt:""}})]),t._v(" "),s("div",{staticClass:"popup-container van-hairline--bottom"},[s("div",{staticClass:"font-14"},[t._v("将通过转播的方式保护您的隐私")]),t._v(" "),s("div",{staticClass:"yinsihao-mobile"},[t._v(t._s(t.yinsihao.secret_mobile)+" 转 "),s("span",{staticClass:"c-danger"},[t._v(t._s(t.yinsihao.extension))])]),t._v(" "),s("div",{staticClass:"yinsihao-tips"},[t._v("拨打"+t._s(t.yinsihao.secret_mobile)),s("br"),t._v("接通后输入分机号"+t._s(t.yinsihao.extension)+"#即可")])]),t._v(" "),s("div",{staticClass:"popup-footer"},[s("div",{staticClass:"yinsihao-cancel",on:{click:function(e){t.showYinsihao=!1}}},[t._v("取消")]),t._v(" "),s("div",{staticClass:"yinsihao-confirm van-hairline--left",on:{click:function(e){t.util.jsTel(t.yinsihao.secret_mobile),t.showYinsihao=!1}}},[t._v("立即呼叫")])])]),t._v(" "),s("van-popup",{staticClass:"yinsihao-popup",model:{value:t.servicePopupStatus,callback:function(e){t.servicePopupStatus=e},expression:"servicePopupStatus"}},[s("div",{staticClass:"popup-title font-500"},[t._v("\n\t\t\t订单已不能使用隐私号联系\n\t\t")]),t._v(" "),s("div",{staticClass:"popup-container padding-15-b van-hairline--bottom"},[t._v("\n\t\t\t为您联系客服\n\t\t")]),t._v(" "),s("div",{staticClass:"popup-footer"},[s("div",{staticClass:"yinsihao-cancel",on:{click:function(e){t.servicePopupStatus=!1}}},[t._v("取消")]),t._v(" "),s("div",{staticClass:"yinsihao-confirm van-hairline--left",on:{click:function(e){t.util.jsTel(t.config_mall.mobile),t.servicePopupStatus=!1}}},[t._v("继续呼叫")])])]),t._v(" "),s("van-popup",{staticClass:"popup-log",attrs:{position:"bottom"},model:{value:t.popup.log,callback:function(e){t.$set(t.popup,"log",e)},expression:"popup.log"}},[s("div",{staticClass:"popup-title font-500 van-hairline--bottom"},[t._v("\n\t\t\t订单跟踪\n\t\t")]),t._v(" "),s("div",{staticClass:"popup-container"},[s("van-steps",{attrs:{direction:"vertical","active-icon":"roundcheckfill",active:t.maxid,"active-color":"#ff2d4b"}},t._l(t.logs,function(e,a){return s("van-step",{key:a},[s("div",{staticClass:"flex-lr"},[s("div",[t._v(t._s(e.title))]),t._v(" "),s("div",{staticClass:"c-gray font-12"},[t._v(t._s(e.addtime))])]),t._v(" "),e.note?s("div",{staticClass:"font-12 c-gray margin-5-t",domProps:{innerHTML:t._s(e.note)}}):t._e()])}),1)],1)])],2)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"share-inner"},[e("div",{staticClass:"icon icon-share"})])}]};var h=s("VU/8")(u,g,!1,function(t){s("9uqi")},null,null);e.default=h.exports}});
//# sourceMappingURL=166.660bbcc1daea6d927f70.js.map