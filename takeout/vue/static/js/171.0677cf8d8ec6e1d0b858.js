webpackJsonp([171],{"1GwF":function(t,e){},"5OHU":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("Gu7T"),a=n.n(r),i=n("mzkE"),s=n("Cz8s"),o=(n("KgXo"),n("NPH5")),d=n("rniE"),l=n("Fd2+"),u={components:{PublicHeader:s.a,PublicFooter:i.a,load:o.a,OrderStatusWarpper:d.a,Dialog:l.a},data:function(){return{orderStatusArr:[{text:"全部"},{text:"待确认"},{text:"处理中"},{text:"待配送"},{text:"配送中"},{text:"已完成"},{text:"已取消"}],orders:{page:1,psize:10,finished:!1,loading:!1,data:[]},filter:{items:{status:0}},config_mall:{},errander_status:"",showPreLoading:!0,menufooter:{},order_remind:{}}},methods:{onToggleStatus:function(t){this.filter.items.status=t,this.onLoad(!0)},onChangeStatus:function(t,e){if("cancel"==e)var n={url:"wmall/order/index/cancel?id="+t,confirm:"确定取消订单吗?"};else if("end_1"==e||"end_2"==e){n={url:"wmall/order/index/end?id="+t,confirm:"你确定收到该商家的外卖?",successUrl:"/mall/pages/order/comment?id="+t};"end_2"==e&&(n.confirm="你确定收到该商家的外卖?")}else if("remind"==e)n={url:"wmall/order/index/remind?id="+t};this.util.jspost(n)},onFinishMealPay:function(){l.a.confirm({title:"温馨提示",message:"您的支付方式为餐后支付，请到商家收银台付款"}).then(function(){})},onLoad:function(t){var e=this;if(t&&(this.orders={page:1,psize:10,loading:!0,finished:!1,data:[]}),this.orders.finished)return!1;this.util.request({url:"wmall/mall/order/list",data:{page:this.orders.page,psize:this.orders.psize,status:this.filter.items.status,menufooter:1,order_remind:1}}).then(function(t){var n=t.data.message;n.errno?e.$toast(n.message):(e.hideLoading(),n=n.message,e.orders.data=[].concat(a()(e.orders.data),a()(n.orders)),e.orders.loading=!1,e.config_mall=n.config_mall,e.errander_status=n.errander_status,n.orders.length<e.orders.psize&&(e.orders.finished=!0),e.orders.page++,e.menufooter=window.menufooter,e.order_remind=window.order,e.orderStatusArr=[].concat(a()(n.order_status)))})},hideLoading:function(){this.showPreLoading=!1}},mounted:function(){this.util.jsauth()}},c={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"mall-order-list"}},[n("public-header",{attrs:{title:"我的订单"}}),t._v(" "),t.order_remind&&t.order_remind.log?n("order-status-warpper",{attrs:{order:t.order_remind}}):t._e(),t._v(" "),n("public-footer",{attrs:{preLoading:t.showPreLoading,menufooter:t.menufooter}}),t._v(" "),n("div",{staticClass:"content"},[n("van-tabs",{attrs:{sticky:"","offset-top":"46"},on:{change:t.onToggleStatus},model:{value:t.filter.items.status,callback:function(e){t.$set(t.filter.items,"status",e)},expression:"filter.items.status"}},t._l(t.orderStatusArr,function(e,r){return n("van-tab",{key:r,attrs:{title:e.text}},[n("van-list",{attrs:{finished:t.orders.finished,offset:100,"immediate-check":!0},on:{load:t.onLoad},model:{value:t.orders.loading,callback:function(e){t.$set(t.orders,"loading",e)},expression:"orders.loading"}},[t.orders.data.length>0?[t._l(t.orders.data,function(e,r){return[n("div",{staticClass:"order-item"},[n("div",{staticClass:"info",on:{click:function(n){return t.util.jsUrl("/mall/pages/order/detail",{id:e.id})}}},[n("div",{staticClass:"flex-lr"},[n("div",[n("span",[t._v("送达时间")]),t._v(" "),n("span",[t._v(t._s(e.delivery_day)+t._s(e.delivery_time))])]),t._v(" "),n("div",[t._v(t._s(e.status_cn))])]),t._v(" "),n("div",{staticClass:"goods-list"},t._l(e.goods,function(t,e){return n("div",{key:e,staticClass:"goods-item"},[n("div",{staticClass:"goods-thumb van-hairline--surround"},[n("img",{staticClass:"img-100",attrs:{src:t.thumb,alt:""}})])])}),0),t._v(" "),n("div",{staticClass:"total"},[n("div",{staticClass:"margin-10-r font-12"},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t共\n\t\t\t\t\t\t\t\t\t\t\t"),n("span",[t._v(t._s(e.goods_num))]),t._v("\n\t\t\t\t\t\t\t\t\t\t\t类商品\n\t\t\t\t\t\t\t\t\t\t")]),t._v(" "),n("div",{staticClass:"c-danger"},[n("span",{staticClass:"font-12"},[t._v(t._s(t.Lang.dollarSign))]),n("span",{staticClass:"font-16 font-bold"},[t._v(t._s(e.final_fee))])])])]),t._v(" "),n("div",{staticClass:"btn-group van-hairline--top"},[0==e.is_pay&&e.status<5?[n("van-button",{attrs:{plain:"",round:"",hairline:"",type:"default"},on:{click:function(n){return t.util.jsUrl("/pages/public/pay",{order_id:e.id,order_type:"takeout"})}}},[t._v("立即支付")])]:t._e(),t._v(" "),1==e.status?[n("van-button",{attrs:{plain:"",round:"",hairline:"",size:"normal",type:"danger"},on:{click:function(n){return t.onChangeStatus(e.id,"cancel")}}},[t._v("取消订单")]),t._v(" "),1==e.is_pay?n("van-button",{attrs:{plain:"",round:"",hairline:"",size:"normal",type:"danger"},on:{click:function(n){return t.onChangeStatus(e.id,"remind")}}},[t._v("催单")]):t._e()]:e.status>1&&e.status<5?[1==e.customer_cancel_status?n("van-button",{attrs:{plain:"",round:"",hairline:"",size:"normal",type:"danger"},on:{click:function(n){return t.onChangeStatus(e.id,"cancel")}}},[t._v("取消订单")]):t._e(),t._v(" "),1==e.order_type&&4==e.status?n("van-button",{attrs:{plain:"",round:"",hairline:"",size:"normal"},on:{click:function(n){return t.onChangeStatus(e.id,"end_1")}}},[t._v("确认送达")]):t._e(),t._v(" "),1==e.is_pay?n("van-button",{attrs:{plain:"",round:"",hairline:"",size:"normal"},on:{click:function(n){return t.onChangeStatus(e.id,"remind")}}},[t._v("催单")]):t._e()]:5==e.status?[n("van-button",{attrs:{plain:"",round:"",hairline:"",size:"normal"},on:{click:function(n){return t.util.jsUrl("/mall/pages/cart/index",{order_id:e.id})}}},[t._v("再来一单")]),t._v(" "),0==e.is_comment?n("van-button",{attrs:{plain:"",round:"",hairline:"",size:"normal"},on:{click:function(n){return t.util.jsUrl("/mall/pages/order/comment",{id:e.id})}}},[t._v("去评价")]):t._e()]:6==e.status?[n("van-button",{attrs:{plain:"",round:"",hairline:"",size:"normal"},on:{click:function(n){return t.util.jsUrl("/mall/pages/cart/index",{order_id:e.id})}}},[t._v("再来一单")])]:t._e(),t._v(" "),1==e.is_refund?n("van-button",{attrs:{plain:"",round:"",hairline:"",size:"normal"},on:{click:function(n){return t.util.jsUrl("/mall/pages/order/detail",{id:e.id})}}},[t._v("查看退款")]):t._e()],2)])]}),t._v(" "),t.orders.finished?n("load",{attrs:{type:"loaded",text:"我是有底线的",bgcolor:"#f5f5f5"}}):t._e()]:n("div",{staticClass:"common-no-con"},[n("img",{attrs:{src:"static/img/order_no_con.png",alt:""}}),t._v(" "),n("p",[t._v("您还没有订单，赶紧点一份！")]),t._v(" "),n("router-link",{staticClass:"common-no-con-a",attrs:{to:t.util.getUrl({path:"/mall/pages/home/category"})}},[t._v("现在点一份")])],1)],2)],1)}),1)],1)],1)},staticRenderFns:[]};var _=n("VU/8")(u,c,!1,function(t){n("1GwF")},null,null);e.default=_.exports}});
//# sourceMappingURL=171.0677cf8d8ec6e1d0b858.js.map