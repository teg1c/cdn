webpackJsonp([71],{AtH1:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("Gu7T"),i=s.n(a),o=s("Cz8s"),n=s("mzkE"),c=s("NPH5"),l=s("MHEY"),r={name:"StoreGoods",data:function(){return{type:0,note:1,commentHeight:500,tabsTop:63,title:"",store:{is_rest:0,activity:{num:0},svip:{},data:{header_style:"0"}},stat:{},comments:[],min:0,loaded:!1,loading:!1,empty:!1,showRedpacketIcon:!1,searchBarOpacity:0,preLoading:!0}},components:{PublicHeader:o.a,PublicFooter:n.a,Load:c.a,StoreHeader:l.a},methods:{onLoad:function(t){var e=this,s=this;if(t&&(s.min=0,s.comments=[],s.loaded=!1,s.loading=!1,s.empty=!1),s.loaded)return!1;s.loading=!0,s.util.request({url:"wmall/store/comment",data:{note:s.note,type:s.type,sid:s.$route.query.sid,min:s.min}}).then(function(t){var a=t.data.message;s.title=a.message.store.title,s.store=a.message.store,e.store.headerStyle=window.theme.storeheaderstyle,s.stat=a.message.stat,s.comments=[].concat(i()(s.comments),i()(a.message.comments)),s.util.setWXTitle(s.store.title),s.comments.length||(s.loaded=!0,s.empty=!0),a.min||(s.loaded=!0),s.loading=!1,s.min=a.min,s.preLoading=!1,setTimeout(function(){var t=document.getElementById("store-header").clientHeight;if(2==s.store.headerStyle){var e=document.getElementsByClassName("search-bar")[0];e&&(s.tabsTop=e.clientHeight),window.addEventListener("scroll",function(){var e=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop;e>=s.tabsTop?s.showRedpacketIcon||(s.showRedpacketIcon=!0):s.showRedpacketIcon&&(s.showRedpacketIcon=!1);var a=t-s.tabsTop;s.searchBarOpacity=e/a})}else{var a=document.documentElement.clientHeight,i=document.getElementsByClassName("store-tabs")[0].clientHeight;if(s.commentHeight=a-t-i,document.getElementById("public-header")){var o=document.getElementById("public-header").clientHeight;s.commentHeight=s.commentHeight-o}}},200)})},onChangeType:function(t){this.type!=t&&(this.type=t,this.onLoad(!0))},onCheckedReadComment:function(){1==this.note?this.note=0:this.note=1,this.onLoad(!0)}},mounted:function(){this.onLoad()},beforeDestroy:function(){window.scrollTo(0,0),window.removeEventListener("scroll",function(){},!0)}},d={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"store-comment"}},[t.isWeixin||t.store.headerStyle?t._e():s("public-header",{attrs:{title:t.store.title}}),t._v(" "),s("store-header",{attrs:{store:t.store,showRedpacketIcon:t.showRedpacketIcon,searchBarOpacity:t.searchBarOpacity}}),t._v(" "),s("div",{staticClass:"store-tabs flex-lr van-hairline--bottom",style:{position:2==t.store.headerStyle?"sticky":"relative",top:(2==t.store.headerStyle?t.tabsTop:0)+"px"}},[s("router-link",{staticClass:"tab-item",attrs:{to:t.util.getUrl({path:"/pages/store/goods?sid="+t.store.id}),tag:"div"}},[t._v("商品")]),t._v(" "),s("div",{staticClass:"tab-item active"},[t._v("评价 "),s("span",{staticClass:"comment-num"},[t._v(t._s(t.store.comment_num))])]),t._v(" "),s("router-link",{staticClass:"tab-item",attrs:{to:t.util.getUrl({path:"/pages/store/index?sid="+t.store.id}),tag:"div"}},[t._v("商家")])],1),t._v(" "),t.preLoading?t._e():s("div",{staticClass:"comment-wrap",style:{height:2==t.store.headerStyle?"auto":t.commentHeight+"px",overflowY:2==t.store.headerStyle?"visible":"auto"}},[s("div",{staticClass:"stat van-hairline--bottom"},[s("div",{staticClass:"stat-score"},[s("div",{staticClass:"score-avg"},[t._v(t._s(t.stat.score))]),t._v(" "),s("div",{staticClass:"score-rate"},[s("p",{staticClass:"score-title"},[t._v("高于"+t._s(t.stat.more_than)+"%的商家")]),t._v(" "),s("van-rate",{attrs:{size:12,"disabled-color":t.util.defaultColor+"!important",disabled:""},model:{value:t.stat.score,callback:function(e){t.$set(t.stat,"score",e)},expression:"stat.score"}})],1)]),t._v(" "),s("div",{staticClass:"score-item"},[s("span",{staticClass:"score-title"},[t._v("商品")]),t._v(" "),s("span",{staticClass:"score-value"},[t._v(t._s(t.stat.goods_quality))])]),t._v(" "),s("div",{staticClass:"score-item"},[s("span",{staticClass:"score-title"},[t._v("配送")]),t._v(" "),s("span",{staticClass:"score-value"},[t._v(t._s(t.stat.delivery_service))])]),t._v(" "),s("div",{staticClass:"score-delivery van-hairline--left"},[s("span",{staticClass:"score-title"},[t._v("配送满意度")]),t._v(" "),s("span",{staticClass:"score-value"},[t._v(" "+t._s(t.stat.delivery_service_percent)+"%")])])]),t._v(" "),s("div",{staticClass:"comments"},[s("ul",{staticClass:"filters"},[s("li",{staticClass:"filter-item",class:{active:0==t.type},on:{click:function(e){return t.onChangeType(0)}}},[t._v("全部 "+t._s(t.stat.all))]),t._v(" "),s("li",{staticClass:"filter-item",class:{active:1==t.type},on:{click:function(e){return t.onChangeType(1)}}},[t._v("好评 "+t._s(t.stat.good))]),t._v(" "),s("li",{staticClass:"filter-item",class:{active:2==t.type},on:{click:function(e){return t.onChangeType(2)}}},[t._v("中评 "+t._s(t.stat.middle))]),t._v(" "),s("li",{staticClass:"filter-item",class:{active:3==t.type},on:{click:function(e){return t.onChangeType(3)}}},[t._v("差评 "+t._s(t.stat.bad))])]),t._v(" "),s("div",{staticClass:"read-comment"},[s("div",{staticClass:"read-comment-group",on:{click:t.onCheckedReadComment}},[s("i",{staticClass:"icon",class:{"icon-check":1==t.note}}),t._v(" "),s("span",[t._v("只看有内容的评价")])])]),t._v(" "),t.empty?s("van-empty",{attrs:{image:"https://cube.elemecdn.com/b/f4/f52ec5ee320b5431c914f57be4a34png.png"}}):s("van-list",{attrs:{finished:t.loaded,offset:100,"immediate-check":!1},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.comments,function(e,a){return s("div",{key:a,staticClass:"comment-item"},[s("div",{staticClass:"top"},[s("img",{staticClass:"avatar bg-img",attrs:{src:e.avatar}}),t._v(" "),s("div",[s("div",{staticClass:"right-top"},[s("h3",{staticClass:"username"},[t._v(t._s(e.mobile))]),t._v(" "),s("div",{staticClass:"svip"},[t._e()]),t._v(" "),s("small",{staticClass:"addtime"},[t._v(t._s(e.addtime))])]),t._v(" "),s("div",{staticClass:"right-bottom"},[s("span",{staticClass:"user-rate"},[t._v("\n\t\t\t\t\t\t\t\t\t配送\n\t\t\t\t\t\t\t\t\t"),s("span",{staticClass:"rate-text"},[t._v(t._s(e.delivery_service_cn)+" ")])]),t._v(" "),s("span",{staticClass:"user-rate user-rate-goods"},[t._v("\n\t\t\t\t\t\t\t\t\t商品\n\t\t\t\t\t\t\t\t\t"),s("span",{staticClass:"rate-text"},[t._v(t._s(e.goods_quality_cn))])]),t._v(" "),t._e()])])]),t._v(" "),s("div",{staticClass:"bottom"},[e.note?s("div",{staticClass:"note"},[t._v(t._s(e.note))]):t._e(),t._v(" "),e.data.good&&e.data.good.length>0?s("div",{staticClass:"recommend"},t._l(e.data.good,function(e,a){return s("span",{key:a,staticClass:"recommend-item"},[t._v(t._s(e))])}),0):t._e(),t._v(" "),e.thumbs&&e.thumbs.length>0?s("ul",{staticClass:"thumbs",class:"thumbs-"+e.thumb_col,style:{"--image-cols-of-row":e.thumb_col}},t._l(e.thumbs,function(a,i){return s("li",{key:i,on:{click:function(s){return t.util.jsPreviewImage(e.thumbs,i)}}},[s("img",{attrs:{src:a}})])}),0):t._e(),t._v(" "),e.reply?s("div",{staticClass:"reply"},[s("div",{staticClass:"reply-text"},[t._v("商家回复")]),t._v("\n\t\t\t\t\t\t\t"+t._s(e.reply)+"\n\t\t\t\t\t\t")]):t._e()])])}),0)],1)]),t._v(" "),s("transition",{attrs:{name:"loading"}},[t.preLoading?s("iloading"):t._e()],1)],1)},staticRenderFns:[]};var m=s("VU/8")(r,d,!1,function(t){s("MmMs")},null,null);e.default=m.exports},MmMs:function(t,e){}});
//# sourceMappingURL=71.c3ee63ecf563e56ee78a.js.map