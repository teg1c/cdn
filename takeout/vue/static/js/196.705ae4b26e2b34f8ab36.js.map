{"version":3,"sources":["webpack:///src/pages/order/map.vue","webpack:///./src/pages/order/map.vue?c51f","webpack:///./src/pages/order/map.vue"],"names":["map","name","data","id","Number","markers","center","lat","lng","order","deliveryer_marker","AMap","GMap","MapType","this","util","getStorage","methods","onLoad","_this","request","url","then","res","result","message","errno","$toast","status","concat","toConsumableArray_default","latitude","longitude","loadmap","that","Object","google","maps","Map","document","getElementById","parseFloat","zoom","disableDefaultUI","bounds","_USGSOverlay","bounds_","map_","div_","setMap","memberOverlay","prototype","OverlayView","onRemove","parentNode","removeChild","onAdd","div","createElement","className","getPanes","overlayLayer","appendChild","draw","overlayProjection","getProjection","sw","fromLatLngToDivPixel","getSouthWest","ne","getNorthEast","style","left","x","top","y","LatLngBounds","LatLng","_USGSOverlay2","storeOverlay","img","src","vue_icon","USGSOverlay","deliveryerOverlay","delivery_success_location_x","delivery_success_location_y","marker","resizeEnable","Marker","position","offset","Pixel","content","params","deliveryer","avatar","push","setFitView","onRefresh","deliveryer_id","location_x","location_y","remove","onQuestion","$dialog","confirm","showCancelButton","created","$route","query","mounted","_this2","setInterval","order_map","render","_h","$createElement","_c","_self","attrs","_v","staticClass","tag","to","getUrl","path","on","click","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/196.705ae4b26e2b34f8ab36.js","sourcesContent":["<template>\r\n\t<div id=\"order-map\">\r\n\t\t<div id=\"map-container\"></div>\r\n\t\t<router-link tag=\"div\" :to=\"util.getUrl({path: '/pages/order/detail', query: {id: id}})\" class=\"icons back-icon\">\r\n\t\t\t<div class=\"icon icon-arrow-left\"></div>\r\n\t\t</router-link>\r\n\t\t<div class=\"icons refresh-icon\" @click=\"onRefresh\">\r\n\t\t\t<div class=\"icon icon-refresh\"></div>\r\n\t\t</div>\r\n\t\t<div class=\"icons question-icon\" @click=\"onQuestion\">\r\n\t\t\t<div class=\"icon icon-question font-20\"></div>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n\timport {Amap} from '@/config/AMap';\r\n\timport {GMap} from '@/config/GMap';\r\n\texport default {\r\n\t\tname: \"orderMap\",\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tid: Number,\r\n\t\t\t\tmarkers: [],\r\n\t\t\t\tcenter: {\r\n\t\t\t\t\tlat: '',\r\n\t\t\t\t\tlng: '',\r\n\t\t\t\t},\r\n\t\t\t\torder: {},\r\n\t\t\t\tdeliveryer_marker: [],\r\n\t\t\t\tAMap: {},\r\n\t\t\t\tGMap: {},\r\n\t\t\t\tMapType: this.util.getStorage('MapType')\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tonLoad() {\r\n\t\t\t\tthis.util.request({\r\n\t\t\t\t\turl: 'wmall/order/index/location',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tid: this.id\r\n\t\t\t\t\t}\r\n\t\t\t\t}).then((res) => {\r\n\t\t\t\t\tvar result = res.data.message;\r\n\t\t\t\t\tif(result.errno) {\r\n\t\t\t\t\t\tthis.util.$toast(result.message);\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.order = result.message.order;\r\n\t\t\t\t\tif(this.order.status == 5) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.markers = [...this.markers, ...result.message.markers];\r\n\t\t\t\t\tthis.center.lat = result.message.markers[0].latitude;\r\n\t\t\t\t\tthis.center.lng = result.message.markers[0].longitude;\r\n\t\t\t\t\tthis.loadmap();\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tloadmap(){\r\n\t\t\t\tvar that = this;\r\n\t\t\t\tif(that.MapType == 'google') {\r\n\t\t\t\t\tthat.GMap = GMap();\r\n\t\t\t\t\tthat.GMap.then(function(google) {\r\n\t\t\t\t\t\tthat.map = new google.maps.Map(document.getElementById('map-container'), {\r\n\t\t\t\t\t\t\tcenter: {\r\n\t\t\t\t\t\t\t\tlat: parseFloat(that.center.lat),\r\n\t\t\t\t\t\t\t\tlng: parseFloat(that.center.lng)\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tzoom: 10,\r\n\t\t\t\t\t\t\tdisableDefaultUI: true  //禁用默认UI\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tvar bounds = {};\r\n\t\t\t\t\t\t//顾客位置\r\n\t\t\t\t\t\tif(that.markers[0].longitude && that.markers[0].latitude) {\r\n\t\t\t\t\t\t\tif(that.memberOverlay) {\r\n\t\t\t\t\t\t\t\tthat.memberOverlay.setMap(null);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tUSGSOverlay.prototype = new google.maps.OverlayView();\r\n\t\t\t\t\t\t\tfunction USGSOverlay(bounds, map) {\r\n\t\t\t\t\t\t\t\tthis.bounds_ = bounds;\r\n\t\t\t\t\t\t\t\tthis.map_ = map;\r\n\t\t\t\t\t\t\t\tthis.div_ = null;\r\n\t\t\t\t\t\t\t\tthis.setMap(map);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tUSGSOverlay.prototype.onRemove = function() {\r\n\t\t\t\t\t\t\t\tthis.div_.parentNode.removeChild(this.div_);\r\n\t\t\t\t\t\t\t\tthis.div_ = null;\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tUSGSOverlay.prototype.onAdd = function() {\r\n\t\t\t\t\t\t\t\tvar div = document.createElement('div');\r\n\t\t\t\t\t\t\t\tdiv.className = 'marker-mine-route';\r\n\t\t\t\t\t\t\t\tthis.div_ = div;\r\n\t\t\t\t\t\t\t\tvar panes = this.getPanes();\r\n\t\t\t\t\t\t\t\tpanes.overlayLayer.appendChild(div);\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tUSGSOverlay.prototype.draw = function() {\r\n\t\t\t\t\t\t\t\tvar overlayProjection = this.getProjection();\r\n\t\t\t\t\t\t\t\tvar sw = overlayProjection.fromLatLngToDivPixel(this.bounds_.getSouthWest());\r\n\t\t\t\t\t\t\t\tvar ne = overlayProjection.fromLatLngToDivPixel(this.bounds_.getNorthEast());\r\n\t\t\t\t\t\t\t\tvar div = this.div_;\r\n\t\t\t\t\t\t\t\tdiv.style.left = sw.x - 35 + 'px';\r\n\t\t\t\t\t\t\t\tdiv.style.top = ne.y - 35 + 'px';\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tbounds = new google.maps.LatLngBounds(\r\n\t\t\t\t\t\t\t\tnew google.maps.LatLng(parseFloat(that.markers[0].latitude), parseFloat(that.markers[0].longitude))\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tthat.memberOverlay = new USGSOverlay(bounds, that.map);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// 商家位置\r\n\t\t\t\t\t\tif(that.markers[2].longitude && that.markers[2].latitude) {\r\n\t\t\t\t\t\t\tif(that.storeOverlay) {\r\n\t\t\t\t\t\t\t\tthat.storeOverlay.setMap(null);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tUSGSOverlay.prototype = new google.maps.OverlayView();\r\n\t\t\t\t\t\t\tfunction USGSOverlay(bounds, map) {\r\n\t\t\t\t\t\t\t\tthis.bounds_ = bounds;\r\n\t\t\t\t\t\t\t\tthis.map_ = map;\r\n\t\t\t\t\t\t\t\tthis.div_ = null;\r\n\t\t\t\t\t\t\t\tthis.setMap(map);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tUSGSOverlay.prototype.onRemove = function() {\r\n\t\t\t\t\t\t\t\tthis.div_.parentNode.removeChild(this.div_);\r\n\t\t\t\t\t\t\t\tthis.div_ = null;\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tUSGSOverlay.prototype.onAdd = function() {\r\n\t\t\t\t\t\t\t\tvar div = document.createElement('div');\r\n\t\t\t\t\t\t\t\tdiv.className = 'marker-start-head-route';\r\n\t\t\t\t\t\t\t\tvar img = document.createElement('img');\r\n\t\t\t\t\t\t\t\timg.src = that.markers[2].vue_icon;\r\n\t\t\t\t\t\t\t\tdiv.appendChild(img);\r\n\t\t\t\t\t\t\t\tthis.div_ = div;\r\n\t\t\t\t\t\t\t\tvar panes = this.getPanes();\r\n\t\t\t\t\t\t\t\tpanes.overlayLayer.appendChild(div);\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tUSGSOverlay.prototype.draw = function() {\r\n\t\t\t\t\t\t\t\tvar overlayProjection = this.getProjection();\r\n\t\t\t\t\t\t\t\tvar sw = overlayProjection.fromLatLngToDivPixel(this.bounds_.getSouthWest());\r\n\t\t\t\t\t\t\t\tvar ne = overlayProjection.fromLatLngToDivPixel(this.bounds_.getNorthEast());\r\n\t\t\t\t\t\t\t\tvar div = this.div_;\r\n\t\t\t\t\t\t\t\tdiv.style.left = sw.x - 35 + 'px';\r\n\t\t\t\t\t\t\t\tdiv.style.top = ne.y - 140 + 'px';\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tbounds = new google.maps.LatLngBounds(\r\n\t\t\t\t\t\t\t\tnew google.maps.LatLng(parseFloat(that.markers[2].latitude), parseFloat(that.markers[2].longitude))\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tthat.storeOverlay = new USGSOverlay(bounds, that.map);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// 配送员位置\r\n\t\t\t\t\t\tif(that.deliveryerOverlay) {\r\n\t\t\t\t\t\t\tthat.deliveryerOverlay.setMap(null);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tUSGSOverlay.prototype = new google.maps.OverlayView();\r\n\t\t\t\t\t\tfunction USGSOverlay(bounds, map) {\r\n\t\t\t\t\t\t\tthis.bounds_ = bounds;\r\n\t\t\t\t\t\t\tthis.map_ = map;\r\n\t\t\t\t\t\t\tthis.div_ = null;\r\n\t\t\t\t\t\t\tthis.setMap(map);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tUSGSOverlay.prototype.onRemove = function() {\r\n\t\t\t\t\t\t\tthis.div_.parentNode.removeChild(this.div_);\r\n\t\t\t\t\t\t\tthis.div_ = null;\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tUSGSOverlay.prototype.onAdd = function() {\r\n\t\t\t\t\t\t\tvar div = document.createElement('div');\r\n\t\t\t\t\t\t\tdiv.className = 'marker-deliveyer-route';\r\n\t\t\t\t\t\t\tvar img = document.createElement('img');\r\n\t\t\t\t\t\t\timg.src = that.markers[1].vue_icon;\r\n\t\t\t\t\t\t\tdiv.appendChild(img);\r\n\t\t\t\t\t\t\tthis.div_ = div;\r\n\t\t\t\t\t\t\tvar panes = this.getPanes();\r\n\t\t\t\t\t\t\tpanes.overlayLayer.appendChild(div);\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tUSGSOverlay.prototype.draw = function() {\r\n\t\t\t\t\t\t\tvar overlayProjection = this.getProjection();\r\n\t\t\t\t\t\t\tvar sw = overlayProjection.fromLatLngToDivPixel(this.bounds_.getSouthWest());\r\n\t\t\t\t\t\t\tvar ne = overlayProjection.fromLatLngToDivPixel(this.bounds_.getNorthEast());\r\n\t\t\t\t\t\t\tvar div = this.div_;\r\n\t\t\t\t\t\t\tdiv.style.left = sw.x - 26 + 'px';\r\n\t\t\t\t\t\t\tdiv.style.top = ne.y - 220 + 'px';\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tif(that.order.status == 5) {\r\n\t\t\t\t\t\t\tbounds = new google.maps.LatLngBounds(\r\n\t\t\t\t\t\t\t\tnew google.maps.LatLng(parseFloat(that.order.delivery_success_location_x), parseFloat(that.order.delivery_success_location_y))\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbounds = new google.maps.LatLngBounds(\r\n\t\t\t\t\t\t\t\tnew google.maps.LatLng(parseFloat(that.markers[1].latitude), parseFloat(that.markers[1].longitude))\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthat.deliveryerOverlay = new USGSOverlay(bounds, that.map);\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthat.AMap = Amap();\r\n\t\t\t\t\tAmap().then(function (AMap) {\r\n\t\t\t\t\t\tthat.map = new AMap.Map('map-container', {\r\n\t\t\t\t\t\t\tresizeEnable: true,\r\n\t\t\t\t\t\t\tcenter: [that.center.lng, that.center.lat],\r\n\t\t\t\t\t\t\tzoom: 10\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t// 顾客位置\r\n\t\t\t\t\t\tif (that.markers[0].longitude && that.markers[0].latitude) {\r\n\t\t\t\t\t\t\tvar marker = new AMap.Marker({\r\n\t\t\t\t\t\t\t\tposition: [that.markers[0].longitude, that.markers[0].latitude],\r\n\t\t\t\t\t\t\t\toffset: new AMap.Pixel(-26, -80),\r\n\t\t\t\t\t\t\t\tcontent: '<div class=\"marker-mine-route\"></div>'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tmarker.setMap(that.map);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// 商家位置\r\n\t\t\t\t\t\tif (that.markers[2].longitude && that.markers[2].latitude) {\r\n\t\t\t\t\t\t\tvar marker = new AMap.Marker({\r\n\t\t\t\t\t\t\t\tposition: [that.markers[2].longitude, that.markers[2].latitude],\r\n\t\t\t\t\t\t\t\toffset: new AMap.Pixel(-33, -70),\r\n\t\t\t\t\t\t\t\tcontent: '<div class=\"marker-start-head-route\"><img src=\"' + that.markers[2].vue_icon + '\" alt=\"\"/></div>'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tmarker.setMap(that.map);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// 配送员位置\r\n\t\t\t\t\t\tif (that.order.status == 5) {\r\n\t\t\t\t\t\t\tvar marker = new AMap.Marker({\r\n\t\t\t\t\t\t\t\tposition: [that.order.delivery_success_location_y, that.order.delivery_success_location_x],\r\n\t\t\t\t\t\t\t\toffset: new AMap.Pixel(-26, -80),\r\n\t\t\t\t\t\t\t\tcontent: '<div class=\"marker-deliveyer-route\"><img src=' + params.deliveryer.avatar + ' alt=\"\"/></div>'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tmarker.setMap(that.map);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (that.markers[1].longitude && that.markers[1].latitude) {\r\n\t\t\t\t\t\t\t\tvar marker = new AMap.Marker({\r\n\t\t\t\t\t\t\t\t\tposition: [that.markers[1].longitude, that.markers[1].latitude],\r\n\t\t\t\t\t\t\t\t\toffset: new AMap.Pixel(-26, -80),\r\n\t\t\t\t\t\t\t\t\tcontent: '<div class=\"marker-deliveyer-route\"><img src=\"' + that.markers[1].vue_icon + '\" alt=\"\"/></div>'\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tmarker.setMap(that.map);\r\n\t\t\t\t\t\t\t\tthat.deliveryer_marker.push(marker);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthat.map.setFitView();\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tonRefresh() {\r\n\t\t\t\tvar that = this;\r\n\t\t\t\tif(that.order.status == 5){\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tthat.util.request({\r\n\t\t\t\t\turl: 'system/common/deliveryer/location',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tid: that.order.deliveryer_id\r\n\t\t\t\t\t}\r\n\t\t\t\t}).then((res) => {\r\n\t\t\t\t\tvar result = res.data.message;\r\n\t\t\t\t\tif(result.errno) {\r\n\t\t\t\t\t\tthat.util.$toast(result.message);\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar deliveryer = result.message;\r\n\t\t\t\t\tif(that.MapType == 'google') {\r\n\t\t\t\t\t\tthat.GMap.then(function(google) {\r\n\t\t\t\t\t\t\tif(that.deliveryerOverlay) {\r\n\t\t\t\t\t\t\t\tthat.deliveryerOverlay.setMap(null);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tUSGSOverlay.prototype = new google.maps.OverlayView();\r\n\t\t\t\t\t\t\tfunction USGSOverlay(bounds, map) {\r\n\t\t\t\t\t\t\t\tthis.bounds_ = bounds;\r\n\t\t\t\t\t\t\t\tthis.map_ = map;\r\n\t\t\t\t\t\t\t\tthis.div_ = null;\r\n\t\t\t\t\t\t\t\tthis.setMap(map);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tUSGSOverlay.prototype.onRemove = function() {\r\n\t\t\t\t\t\t\t\tthis.div_.parentNode.removeChild(this.div_);\r\n\t\t\t\t\t\t\t\tthis.div_ = null;\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tUSGSOverlay.prototype.onAdd = function() {\r\n\t\t\t\t\t\t\t\tvar div = document.createElement('div');\r\n\t\t\t\t\t\t\t\tdiv.className = 'marker-deliveyer-route';\r\n\t\t\t\t\t\t\t\tvar img = document.createElement('img');\r\n\t\t\t\t\t\t\t\timg.src = deliveryer.avatar;\r\n\t\t\t\t\t\t\t\tdiv.appendChild(img);\r\n\t\t\t\t\t\t\t\tthis.div_ = div;\r\n\t\t\t\t\t\t\t\tvar panes = this.getPanes();\r\n\t\t\t\t\t\t\t\tpanes.overlayLayer.appendChild(div);\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tUSGSOverlay.prototype.draw = function() {\r\n\t\t\t\t\t\t\t\tvar overlayProjection = this.getProjection();\r\n\t\t\t\t\t\t\t\tvar sw = overlayProjection.fromLatLngToDivPixel(this.bounds_.getSouthWest());\r\n\t\t\t\t\t\t\t\tvar ne = overlayProjection.fromLatLngToDivPixel(this.bounds_.getNorthEast());\r\n\t\t\t\t\t\t\t\tvar div = this.div_;\r\n\t\t\t\t\t\t\t\tdiv.style.left = sw.x - 26 + 'px';\r\n\t\t\t\t\t\t\t\tdiv.style.top = ne.y - 220 + 'px';\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tvar bounds = new google.maps.LatLngBounds(\r\n\t\t\t\t\t\t\t\tnew google.maps.LatLng(parseFloat(deliveryer.location_x), parseFloat(deliveryer.location_y))\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tthat.deliveryerOverlay = new USGSOverlay(bounds, that.map);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthat.AMap.then(function (AMap) {\r\n\t\t\t\t\t\t\tvar marker = new AMap.Marker({\r\n\t\t\t\t\t\t\t\tposition: [deliveryer.location_y, deliveryer.location_x],\r\n\t\t\t\t\t\t\t\toffset: new AMap.Pixel(-26, -80),\r\n\t\t\t\t\t\t\t\tcontent: '<div class=\"marker-deliveyer-route\"><img src=\"' + deliveryer.avatar + '\" alt=\"\"/></div>'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tthat.map.remove(that.deliveryer_marker);\r\n\t\t\t\t\t\t\tmarker.setMap(that.map);\r\n\t\t\t\t\t\t\tthat.deliveryer_marker.push(marker);\r\n\t\t\t\t\t\t\tthat.map.setFitView();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tonQuestion() {\r\n\t\t\t\tthis.$dialog.confirm({\r\n\t\t\t\t\tmessage: '要获取最新位置，请点击刷新按钮；如果配送员远离您，那可能是正在为更早下单的用户配送，请耐心等待~',\r\n\t\t\t\t\tshowCancelButton: false\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t},\r\n\t\tcreated() {\r\n\t\t\tif(this.$route.query.id) {\r\n\t\t\t\tthis.id = this.$route.query.id\r\n\t\t\t} else {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\tthis.onLoad();\r\n\t\t\tsetInterval(() => {\r\n\t\t\t\tthis.onRefresh();\r\n\t\t\t}, 30000)\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t#order-map{\r\n\t\tposition: fixed;\r\n\t\ttop: 0;\r\n\t\tright: 0;\r\n\t\tbottom: 0;\r\n\t\tleft: 0;\r\n\t}\r\n\t#order-map #map-container{\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t}\r\n\t#order-map .icons{\r\n\t\tposition: absolute;\r\n\t\tz-index: 100;\r\n\t\theight: 36px;\r\n\t\twidth: 36px;\r\n\t\ttext-align: center;\r\n\t\tline-height: 36px;\r\n\t\tborder-radius: 100%;\r\n\t\tbackground: #9b9a96;\r\n\t\topacity: 0.8;\r\n\t\tcolor: #FFF;\r\n\t}\r\n\t#order-map .back-icon{\r\n\t\ttop: 15px;\r\n\t\tleft: 15px;\r\n\t}\r\n\t#order-map .refresh-icon{\r\n\t\ttop: 15px;\r\n\t\tright: 15px;\r\n\t}\r\n\t#order-map .question-icon{\r\n\t\tbottom: 15px;\r\n\t\tright: 15px;\r\n\t}\r\n\t#order-map .marker-deliveyer-route{\r\n\t\tposition: relative;\r\n\t\twidth: 52px;\r\n\t\theight: 80px;\r\n\t\tcolor: #e90000;\r\n\t\tbackground: url(../../../static/img/map-location.png) no-repeat 0 0;\r\n\t\tcursor: pointer;\r\n\t}\r\n\t#order-map .marker-deliveyer-route img{\r\n\t\tposition:absolute;\r\n\t\ttop: 5px;\r\n\t\tright: 5px;\r\n\t\twidth: 42px;\r\n\t\theight: 42px;\r\n\t\tborder-radius: 100%;\r\n\t}\r\n\t#order-map .marker-start-head-route {\r\n\t\tposition: relative;\r\n\t\twidth: 70px;\r\n\t\theight: 70px;\r\n\t\tcolor: #e90000;\r\n\t\tbackground: url(../../../static/img/map-start-head.png) no-repeat 0 0;\r\n\t\tbackground-size: cover;\r\n\t\tcursor: pointer;\r\n\t}\r\n\t#order-map .marker-start-head-route img {\r\n\t\tposition: absolute;\r\n\t\ttop: 12px;\r\n\t\tright: 12px;\r\n\t\twidth: 46px;\r\n\t\theight: 46px;\r\n\t\tborder-radius: 100%\r\n\t}\r\n\t#order-map .marker-mine-route {\r\n\t\tposition: relative;\r\n\t\twidth: 70px;\r\n\t\theight: 70px;\r\n\t\tcolor: #e90000;\r\n\t\tbackground: url(../../../static/img/map-lbs.png) no-repeat 0 0;\r\n\t\tbackground-size: cover;\r\n\t\tcursor: pointer;\r\n\t}\r\n\t#order-map .marker-mine-route img {\r\n\t\tposition: absolute;\r\n\t\ttop: 12px;\r\n\t\tright: 12px;\r\n\t\twidth: 46px;\r\n\t\theight: 46px;\r\n\t\tborder-radius: 100%\r\n\t}\r\n</style>\n\n\n// WEBPACK FOOTER //\n// src/pages/order/map.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"order-map\"}},[_c('div',{attrs:{\"id\":\"map-container\"}}),_vm._v(\" \"),_c('router-link',{staticClass:\"icons back-icon\",attrs:{\"tag\":\"div\",\"to\":_vm.util.getUrl({path: '/pages/order/detail', query: {id: _vm.id}})}},[_c('div',{staticClass:\"icon icon-arrow-left\"})]),_vm._v(\" \"),_c('div',{staticClass:\"icons refresh-icon\",on:{\"click\":_vm.onRefresh}},[_c('div',{staticClass:\"icon icon-refresh\"})]),_vm._v(\" \"),_c('div',{staticClass:\"icons question-icon\",on:{\"click\":_vm.onQuestion}},[_c('div',{staticClass:\"icon icon-question font-20\"})])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-3c60ca7c\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/order/map.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-3c60ca7c\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./map.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./map.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./map.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-3c60ca7c\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./map.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/order/map.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}