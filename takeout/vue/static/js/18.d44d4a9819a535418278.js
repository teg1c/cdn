webpackJsonp([18],{"C6/7":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("Cz8s"),r=n("75NE"),s=n("5Kdi"),a=n("jUC1"),o=n("acch"),l=n("MJLE"),c=n.n(l),u={name:"pay",components:{PublicHeader:i.a,countDown:r.a,StripeCheckout:o.StripeCheckout},data:function(){return{showPreLoading:!0,order_type:"takeout",slides:[],order:{},payment:[],paytype:"",member:{},submitDisabled:!1,is_rmpay:!1,rmpay_info:{},is_stripe:!1,pagebacknum:1,stripe_info:{publishableKey:"",sessionId:"",clientReferenceId:"",qrcode:!1},subTemplateId:""}},methods:{onLoad:function(){var e=this,t=this;this.util.request({url:"system/paycenter/pay",method:"POST",data:{sid:this.sid,id:this.order_id,order_type:this.order_type,type:1}}).then(function(n){e.showPreLoading=!1;var i=n.data.message;if(i.errno)return e.$toast(i.message),!1;if(t.util.isMajia())Object(a.a)().then(function(){var e=window.majia.payinfo;mag.pay(e,function(n){t.util.$toast("订单支付成功",e.url_detail)},function(n){t.util.$toast("支付失败,具体原因："+n,e.url_pay)})});else if(t.util.isQianfan()){var r=window.qianfan.payinfo,s={type:parseInt(r.type),item:r.item,send_type:parseInt(r.send_type),address:r.address,allow_pay_type:parseInt(r.allow_pay_type)};QFH5.createOrder(s.type,s.item,s.send_type,s.address,s.allow_pay_type,function(e,n){if(1==e){var i=n.order_id;t.util.request({url:"system/paycenter/sync/qianfan",data:{tid:r.tid,order_id:i}}).then(function(e){QFH5.jumpPayOrder(i,function(e,n){1==e?t.util.$toast("订单支付成功",r.url_detail):t.util.$toast(n.error,r.url_pay)})})}else t.util.$toast("创建交易订单失败:"+n.error,r.url_pay)})}else{if(e.slides=i.message.slides,e.payment=i.message.payment,i.message.order=e.util.df(i.message.order,2),e.order=i.message.order,e.member=i.message.member,e.is_rmpay=i.message.is_rmpay,e.is_rmpay&&(e.rmpay_info=i.message.rmpay),e.is_stripe=i.message.is_stripe,e.payment.length>0){for(var o=e.payment[0].value,l=0,c=e.payment.length;l<c;l++)"wechat"==e.payment[l].value&&(o="wechat");e.paytype=o}var u=e.util.getUrlParam(window.location.href,"autoPay");u&&(e.paytype=u,e.onSubmit())}})},onSelectPayType:function(e){this.paytype=e,"credit"==this.paytype?(this.member.credit2||(this.member.credit2=0),this.member.credit2-this.order.fee<0&&(this.submitDisabled=!0)):this.submitDisabled=!1},onSubmit:function(){var e=this;if(!this.paytype)return this.$toast("请先选择支付方式"),!1;if(this.util.ish5app()&&("wechat"==this.paytype||"alipay"==this.paytype))return s.a.init({}),s.a.pay(this.paytype,"",""),!1;if(this.submitDisabled=!0,this.is_rmpay&&"credit"!=this.paytype&&"delivery"!=this.paytype){if(!this.rmpay_info.baseurl)return this.$toast(this.rmpay_info.error),this.submitDisabled=!1,!1;this.$toast.loading({message:"pay waiting...",forbidClick:!0}),window.location.href=this.rmpay_info.baseurl+this.paytype}else if(!this.is_stripe||"card"!=this.paytype&&0!=this.paytype.indexOf("card_"))this.util.pay({pay_type:this.paytype,order_type:this.order_type,order_id:this.order_id,extra:this.extra,vue:this});else{var t=this;0==this.paytype.indexOf("card_")?this.util.stripepay({pay_type:this.paytype,order_type:this.order_type,order_id:this.order_id,extra:this.extra,vue:this}):this.util.request({url:"system/paycenter/pay",method:"POST",data:{pay_type:this.paytype,order_type:this.order_type,id:this.order_id},showLoading:!0}).then(function(n){var i=n.data.message;if(i.errno)return e.$toast(i.message),!1;if("wechat"==e.paytype){e.stripe_info.qrcode=!0;new c.a("qrcode",{width:150,height:150,text:i.message.wechat.qr_code_url,image:""})}else"card"==e.paytype&&(e.stripe_info.publishableKey=i.message.publishableKey,e.stripe_info.sessionId=i.message.sessionid,t.$refs.checkoutRef.redirectToCheckout())})}},subSuccess:function(e){console.log("订阅成功",e),this.onSubmit()},subError:function(e){console.log("订阅失败",e),this.onSubmit()}},mounted:function(){this.onLoad()},created:function(){this.query=this.$route.query,this.query&&(this.order_id=this.query.order_id||this.query.id,this.query.order_id||(this.order_id=this.query.id),1==this.query.stripe_back&&(this.pagebacknum=1e3),this.order_type=this.query.order_type,this.extra=this.query.extra)}},d={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.util.isMajia()||e.util.isQianfan()?e._e():n("div",{attrs:{id:"pay"}},[n("public-header",{attrs:{title:"支付收银台",pagebacknum:e.pagebacknum}}),e._v(" "),n("div",{staticClass:"content"},[e.slides&&e.slides.length>0?n("van-swipe",{staticClass:"swiper",attrs:{autoplay:3e3,"indicator-color":"#ff2d4b"}},e._l(e.slides,function(t,i){return n("van-swipe-item",{key:i},[n("div",{on:{click:function(n){return e.util.jsUrl(t.wxapp_link)}}},[n("img",{attrs:{src:t.thumb}})])])}),1):e._e(),e._v(" "),e.order.pay_endtime&&e.order.pay_endtime>0?n("div",{staticClass:"remain-time"},[n("div",[e._v("支付剩余时间")]),e._v(" "),n("div",{staticClass:"in-clock"},[n("count-down",{attrs:{endTime:e.order.pay_endtime}})],1)]):e._e(),e._v(" "),n("div",{staticClass:"order-summary flex-lr"},[n("div",{staticClass:"left"},[n("img",{attrs:{src:e.order.logo,alt:""}})]),e._v(" "),n("div",{staticClass:"right"},[n("div",{staticClass:"fee"},[n("span",{staticClass:"underline"},[e._v(e._s(e.Lang.dollarSign)+e._s(e.order.fee))])]),e._v(" "),n("div",{staticClass:"order-info"},[n("span",{staticClass:"underline"},[e._v(e._s(e.order.title))])])])]),e._v(" "),n("div",{staticClass:"bolck-title"},[e._v("选择支付方式")]),e._v(" "),n("div",{staticClass:"pay-list"},[e._l(e.payment,function(t,i){return[n("div",{staticClass:"pay-item van-hairline--bottom flex-lr",on:{click:function(n){return e.onSelectPayType(t.value)}}},[e.is_rmpay?n("div",{staticClass:"item-inner flex"},["WECHATPAY_MY"==t.value?n("img",{attrs:{src:"static/img/wx-icon.png",alt:""}}):"WECHATPAY_CN"==t.value?n("img",{attrs:{src:"static/img/wx-icon.png",alt:""}}):"ALIPAY_CN"==t.value?n("img",{attrs:{src:"static/img/zfb-icon.png",alt:""}}):"credit"==t.value?n("img",{attrs:{src:"static/img/money-icon.png",alt:""}}):"PRESTO_MY"==t.value?n("img",{attrs:{src:"static/img/wallet-presto.png",alt:""}}):"BOOST_MY"==t.value?n("img",{attrs:{src:"static/img/wallet-boost.png",alt:""}}):"GRABPAY_MY"==t.value?n("img",{attrs:{src:"static/img/wallet-grabpay.png",alt:""}}):"TNG_MY"==t.value?n("img",{attrs:{src:"static/img/wallet-tng.png",alt:""}}):"MAYBANK_MY"==t.value?n("img",{attrs:{src:"static/img/wallet-maybank-qr.png",alt:""}}):"RAZERPAY_MY"==t.value?n("img",{attrs:{src:"static/img/wallet-razerpay.png",alt:""}}):"MCASH_MY"==t.value?n("img",{attrs:{src:"static/img/wallet-mcash.png",alt:""}}):"GOBIZ_MY"==t.value?n("img",{attrs:{src:"static/img/finishMeal-icon.png",alt:""}}):"delivery"==t.value?n("img",{attrs:{src:"static/img/delivery-icon.png",alt:""}}):"finishMeal"==t.value?n("img",{attrs:{src:"static/img/finishMeal-icon.png",alt:""}}):e._e(),e._v(" "),n("div",{staticClass:"item-box"},[n("div",{staticClass:"item-title"},[e._v(e._s(t.title))]),e._v(" "),"credit"==t.value?n("div",{staticClass:"item-subtitle flex"},[e._v("\n\t\t\t\t\t\t\t\t当前账户余额:\n\t\t\t\t\t\t\t\t"),n("span",{staticClass:"money"},[e._v(" "+e._s(e.Lang.dollarSign)+e._s(e.member.credit2||0))])]):e._e(),e._v(" "),"delivery"==t.value?n("div",{staticClass:"item-subtitle flex"},[e._v("\n\t\t\t\t\t\t\t\t线下当面交易，到店付款，货到付款\n\t\t\t\t\t\t\t")]):e._e()])]):n("div",{staticClass:"item-inner flex"},["wechat"==t.value?n("img",{attrs:{src:"static/img/wx-icon.png",alt:""}}):"alipay"==t.value?n("img",{attrs:{src:"static/img/zfb-icon.png",alt:""}}):"credit"==t.value?n("img",{attrs:{src:"static/img/money-icon.png",alt:""}}):"delivery"==t.value?n("img",{attrs:{src:"static/img/delivery-icon.png",alt:""}}):"peerpay"==t.value?n("img",{attrs:{src:"static/img/peerpay-icon.png",alt:""}}):"finishMeal"==t.value?n("img",{attrs:{src:"static/img/finishMeal-icon.png",alt:""}}):"card"==t.value?n("img",{attrs:{src:"static/img/finishMeal-icon.png",alt:""}}):0==t.value.indexOf("card_")?n("img",{attrs:{src:"static/img/finishMeal-icon.png",alt:""}}):e._e(),e._v(" "),n("div",{staticClass:"item-box"},[n("div",{staticClass:"item-title"},[e._v(e._s(t.title))]),e._v(" "),"wechat"==t.value?n("div",{staticClass:"item-subtitle flex"},[n("span",{staticClass:"pay-recommend"},[e._v("推荐使用")]),e._v("\n\t\t\t\t\t\t\t\t微信支付,安全快捷\n\t\t\t\t\t\t\t")]):e._e(),e._v(" "),"alipay"==t.value?n("div",{staticClass:"item-subtitle flex"},[n("span",{staticClass:"pay-recommend"},[e._v("推荐使用")]),e._v("\n\t\t\t\t\t\t\t\t简单、安全、快速\n\t\t\t\t\t\t\t")]):e._e(),e._v(" "),"credit"==t.value?n("div",{staticClass:"item-subtitle flex"},[e._v("\n\t\t\t\t\t\t\t\t当前账户余额:\n\t\t\t\t\t\t\t\t"),n("span",{staticClass:"money"},[e._v(" "+e._s(e.Lang.dollarSign)+e._s(e.member.credit2||0))])]):e._e(),e._v(" "),"delivery"==t.value?n("div",{staticClass:"item-subtitle flex"},[e._v("\n\t\t\t\t\t\t\t\t线下当面交易，到店付款，货到付款\n\t\t\t\t\t\t\t")]):e._e()])]),e._v(" "),n("i",{staticClass:"icon",class:{"icon-check":t.value==e.paytype}})])]})],2)],1),e._v(" "),n("div",{staticClass:"save-btn"},[n("van-button",{attrs:{type:"default",size:"large",disabled:e.submitDisabled},on:{click:e.onSubmit}},[e._v("确认支付 "+e._s(e.Lang.dollarSign)+e._s(e.order.fee))])],1),e._v(" "),n("transition",{attrs:{name:"loading"}},[e.showPreLoading?n("iloading"):e._e()],1),e._v(" "),n("div",[n("stripe-checkout",{ref:"checkoutRef",attrs:{pk:e.stripe_info.publishableKey,"session-id":e.stripe_info.sessionId}})],1)],1)},staticRenderFns:[]};var p=n("VU/8")(u,d,!1,function(e){n("Ktio")},null,null);t.default=p.exports},Ktio:function(e,t){},acch:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=["auto","da","de","en","es","es-419","fi","fr","it","ja","nb","nl","pl","pt","sv","zh"],r=["auto","book","donate","pay"],s=["required","auto"],a={base:{color:"#32325d",fontFamily:'"Helvetica Neue", Helvetica, sans-serif',fontSmoothing:"antialiased",fontSize:"16px","::placeholder":{color:"#aab7c4"}},invalid:{color:"#fa755a",iconColor:"#fa755a"}},o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"v3",t=arguments.length>1?arguments[1]:void 0;if(window.Stripe)t();else{var n=document.createElement("script");n.src="".concat("https://js.stripe.com","/").concat(e),n.type="text/javascript",document.getElementsByTagName("head")[0].appendChild(n),n.addEventListener("load",t)}},l={props:{pk:{type:String,required:!0},mode:{type:String,validator:function(e){return["payment","subscription"].includes(e)}},lineItems:{type:Array,default:null},items:{type:Array},successUrl:{type:String,default:window.location.href},cancelUrl:{type:String,default:window.location.href},submitType:{type:String,validator:function(e){return r.includes(e)}},billingAddressCollection:{type:String,default:"auto",validator:function(e){return s.includes(e)}},clientReferenceId:{type:String},customerEmail:{type:String},sessionId:{type:String},locale:{type:String,default:"auto",validator:function(e){return i.includes(e)}},shippingAddressCollection:{type:Object,validator:function(e){return Object.prototype.hasOwnProperty.call(e,"allowedCountries")}}},render:function(e){return e("div")},methods:{redirectToCheckout:function(){var e=this;this.$emit("loading",!0),o("v3",function(){try{var t=window.Stripe(e.pk);if(e.sessionId)return void t.redirectToCheckout({sessionId:e.sessionId});if(e.lineItems&&e.lineItems.length&&!e.mode)return void console.error("Error: Property 'mode' is required when using 'lineItems'. See https://stripe.com/docs/js/checkout/redirect_to_checkout#stripe_checkout_redirect_to_checkout-options-mode");var n={billingAddressCollection:e.billingAddressCollection,cancelUrl:e.cancelUrl,clientReferenceId:e.clientReferenceId,customerEmail:e.customerEmail,items:e.items,lineItems:e.lineItems,locale:e.locale,mode:e.mode,shippingAddressCollection:e.shippingAddressCollection,submitType:e.submitType,successUrl:e.successUrl};t.redirectToCheckout(n)}catch(t){console.error(t),e.$emit("error",t)}finally{e.$emit("loading",!1)}})}}};var c,u=(function(e){var t=function(e){var t,n=Object.prototype,i=n.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},s=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",o=r.toStringTag||"@@toStringTag";function l(e,t,n,i){var r=t&&t.prototype instanceof f?t:f,s=Object.create(r.prototype),a=new k(i||[]);return s._invoke=function(e,t,n){var i=u;return function(r,s){if(i===p)throw new Error("Generator is already running");if(i===m){if("throw"===r)throw s;return L()}for(n.method=r,n.arg=s;;){var a=n.delegate;if(a){var o=C(a,n);if(o){if(o===h)continue;return o}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===u)throw i=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(e,t,n);if("normal"===l.type){if(i=n.done?m:d,l.arg===h)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=m,n.method="throw",n.arg=l.arg)}}}(e,n,a),s}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u="suspendedStart",d="suspendedYield",p="executing",m="completed",h={};function f(){}function y(){}function v(){}var g={};g[s]=function(){return this};var _=Object.getPrototypeOf,b=_&&_(_(O([])));b&&b!==n&&i.call(b,s)&&(g=b);var w=v.prototype=f.prototype=Object.create(g);function A(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function E(e){var t;this._invoke=function(n,r){function s(){return new Promise(function(t,s){!function t(n,r,s,a){var o=c(e[n],e,r);if("throw"!==o.type){var l=o.arg,u=l.value;return u&&"object"==typeof u&&i.call(u,"__await")?Promise.resolve(u.__await).then(function(e){t("next",e,s,a)},function(e){t("throw",e,s,a)}):Promise.resolve(u).then(function(e){l.value=e,s(l)},function(e){return t("throw",e,s,a)})}a(o.arg)}(n,r,t,s)})}return t=t?t.then(s,s):s()}}function C(e,n){var i=e.iterator[n.method];if(i===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,C(e,n),"throw"===n.method))return h;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var r=c(i,e.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,h;var s=r.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,h):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function O(e){if(e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function n(){for(;++r<e.length;)if(i.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}return{next:L}}function L(){return{value:t,done:!0}}return y.prototype=w.constructor=v,v.constructor=y,v[o]=y.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,o in e||(e[o]="GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},A(E.prototype),E.prototype[a]=function(){return this},e.AsyncIterator=E,e.async=function(t,n,i,r){var s=new E(l(t,n,i,r));return e.isGeneratorFunction(n)?s:s.next().then(function(e){return e.done?e.value:s.next()})},A(w),w[o]="Generator",w[s]=function(){return this},w.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var i=t.pop();if(i in e)return n.value=i,n.done=!1,n}return n.done=!0,n}},e.values=O,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(i,r){return o.type="throw",o.arg=e,n.next=i,r&&(n.method="next",n.arg=t),!!r}for(var s=this.tryEntries.length-1;s>=0;--s){var a=this.tryEntries[s],o=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var l=i.call(a,"catchLoc"),c=i.call(a,"finallyLoc");if(l&&c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var s=r;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var a=s?s.completion:{};return a.type=e,a.arg=t,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;S(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,i){return this.delegate={iterator:O(e),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=t),h}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}(c={exports:{}},c.exports),c.exports);var d=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e};function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach(function(t){d(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var h={props:{pk:{type:String,required:!0},stripeAccount:{type:String},apiVersion:{type:String},locale:{type:String,default:"auto"},elementsOptions:{type:Object,default:function(){return{}}},classes:{type:Object,default:function(){return{}}},elementStyle:{type:Object,default:function(){return a}},value:{type:String},hidePostalCode:Boolean,iconStyle:{type:String,default:"default",validator:function(e){return["solid","default"].includes(e)}},hideIcon:Boolean,disabled:Boolean},data:function(){return{loading:!1,stripe:null,elements:null,element:null,card:null}},computed:{form:function(){return document.getElementById("stripe-element-form")}},mounted:function(){var e=this;o(this.apiVersion,function(){var t={stripeAccount:e.stripeAccount,apiVersion:e.apiVersion,locale:e.locale},n={classes:e.classes,style:e.elementStyle,value:e.value,hidePostalCode:e.hidePostalCode,iconStyle:e.iconStyle,hideIcon:e.hideIcon,disabled:e.disabled};e.stripe=window.Stripe(e.pk,t),e.elements=e.stripe.elements(e.elementsOptions),e.element=e.elements.create("card",n),e.element.mount("#stripe-element-mount-point"),e.element.on("change",function(t){var n=document.getElementById("stripe-element-errors");t.error?n.textContent=t.error.message:n.textContent="",e.change(t)}),e.element.on("ready",e.ready),e.element.on("focus",e.focus),e.element.on("blur",e.blur),e.element.on("escape",e.escape),e.element.on("click",e.click),e.form.addEventListener("submit",function(t){var n,i,r,s;return u.async(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,e.$emit("loading",!0),t.preventDefault(),n=m({},e.element),e.amount&&(n.amount=e.amount),a.next=7,u.awrap(e.stripe.createToken(n));case 7:if(i=a.sent,r=i.token,!(s=i.error)){a.next=15;break}return document.getElementById("stripe-element-errors").textContent=s.message,e.$emit("error",s),a.abrupt("return");case 15:e.$emit("token",r),a.next=22;break;case 18:a.prev=18,a.t0=a.catch(0),console.error(a.t0),e.$emit("error",a.t0);case 22:return a.prev=22,e.$emit("loading",!1),a.finish(22);case 25:case"end":return a.stop()}},null,null,[[0,18,22,25]])})})},methods:{submit:function(){this.$refs.submitButtonRef.click()},change:function(e){this.$emit("element-change",e)},ready:function(e){this.$emit("element-ready",e)},focus:function(e){this.$emit("element-focus",e)},blur:function(e){this.$emit("element-blur",e)},escape:function(e){this.$emit("element-escape",e)},click:function(e){this.$emit("element-click",e)}}};const f="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());let y;const v={};const g=h;var _=function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("form",{attrs:{id:"stripe-element-form"}},[t("div",{attrs:{id:"stripe-element-mount-point"}}),this._v(" "),this._t("stripe-element-errors",[t("div",{attrs:{id:"stripe-element-errors",role:"alert"}})]),this._v(" "),t("button",{ref:"submitButtonRef",staticClass:"hide",attrs:{type:"submit"}})],2)])};_._withStripped=!0;const b=function(e,t,n,i,r,s,a,o,l,c){"boolean"!=typeof a&&(l=o,o=a,a=!1);const u="function"==typeof n?n.options:n;let d;if(e&&e.render&&(u.render=e.render,u.staticRenderFns=e.staticRenderFns,u._compiled=!0,r&&(u.functional=!0)),i&&(u._scopeId=i),s?(d=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,l(e)),e&&e._registeredComponents&&e._registeredComponents.add(s)},u._ssrRegister=d):t&&(d=a?function(e){t.call(this,c(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,o(e))}),d)if(u.functional){const e=u.render;u.render=function(t,n){return d.call(n),e(t,n)}}else{const e=u.beforeCreate;u.beforeCreate=e?[].concat(e,d):[d]}return n}({render:_,staticRenderFns:[]},function(e){e&&e("data-v-38ea8814_0",{source:"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n * The CSS shown here will not be introduced in the Quickstart guide, but shows\n * how you can use CSS to style your Element's container.\n */\n.StripeElement[data-v-38ea8814] {\n  box-sizing: border-box;\n\n  height: 40px;\n\n  padding: 10px 12px;\n\n  border: 1px solid transparent;\n  border-radius: 4px;\n  background-color: white;\n\n  box-shadow: 0 1px 3px 0 #e6ebf1;\n  -webkit-transition: box-shadow 150ms ease;\n  transition: box-shadow 150ms ease;\n}\n.StripeElement--focus[data-v-38ea8814] {\n  box-shadow: 0 1px 3px 0 #cfd7df;\n}\n.StripeElement--invalid[data-v-38ea8814] {\n  border-color: #fa755a;\n}\n.StripeElement--webkit-autofill[data-v-38ea8814] {\n  background-color: #fefde5 !important;\n}\n.hide[data-v-38ea8814] {\n  visibility: hidden;\n}\n",map:{version:3,sources:["/home/runner/work/vue-stripe/vue-stripe/src/elements/Card.vue"],names:[],mappings:";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiKA;;;EAGA;AACA;EACA,sBAAA;;EAEA,YAAA;;EAEA,kBAAA;;EAEA,6BAAA;EACA,kBAAA;EACA,uBAAA;;EAEA,+BAAA;EACA,yCAAA;EACA,iCAAA;AACA;AAEA;EACA,+BAAA;AACA;AAEA;EACA,qBAAA;AACA;AAEA;EACA,oCAAA;AACA;AAEA;EACA,kBAAA;AACA",file:"Card.vue",sourcesContent:["<template>\n  <div>\n    <form id=\"stripe-element-form\">\n      <div id=\"stripe-element-mount-point\"></div>\n      <slot name=\"stripe-element-errors\">\n        <div id=\"stripe-element-errors\" role=\"alert\"></div>\n      </slot>\n      <button ref=\"submitButtonRef\" type=\"submit\" class=\"hide\"></button>\n    </form>\n  </div>\n</template>\n\n<script>\nimport { loadStripeSdk } from '../load-stripe-sdk';\nimport { DEFAULT_ELEMENT_STYLE } from '../constants';\nconst ELEMENT_TYPE = 'card';\nexport default {\n  props: {\n    pk: {\n      type: String,\n      required: true,\n    },\n    stripeAccount: {\n      type: String,\n    },\n    apiVersion: {\n      type: String,\n    },\n    locale: {\n      type: String,\n      default: 'auto',\n    },\n    elementsOptions: {\n      type: Object,\n      default: () => ({}),\n    },\n    // element specific options\n    classes: {\n      type: Object,\n      default: () => ({}),\n    },\n    elementStyle: {\n      type: Object,\n      default: () => (DEFAULT_ELEMENT_STYLE),\n    },\n    value: {\n      type: String,\n    },\n    hidePostalCode: Boolean,\n    iconStyle: {\n      type: String,\n      default: 'default',\n      validator: value => ['solid', 'default'].includes(value),\n    },\n    hideIcon: Boolean,\n    disabled: Boolean,\n  },\n  data () {\n    return {\n      loading: false,\n      stripe: null,\n      elements: null,\n      element: null,\n      card: null,\n    };\n  },\n  computed: {\n    form () {\n      return document.getElementById('stripe-element-form');\n    },\n  },\n  mounted () {\n    loadStripeSdk(this.apiVersion, () => {\n      const stripeOptions = {\n        stripeAccount: this.stripeAccount,\n        apiVersion: this.apiVersion,\n        locale: this.locale,\n      };\n      const createOptions = {\n        classes: this.classes,\n        style: this.elementStyle,\n        value: this.value,\n        hidePostalCode: this.hidePostalCode,\n        iconStyle: this.iconStyle,\n        hideIcon: this.hideIcon,\n        disabled: this.disabled,\n      };\n\n      this.stripe = window.Stripe(this.pk, stripeOptions);\n      this.elements = this.stripe.elements(this.elementsOptions);\n      this.element = this.elements.create(ELEMENT_TYPE, createOptions);\n      this.element.mount('#stripe-element-mount-point');\n\n      this.element.on('change', (event) => {\n        var displayError = document.getElementById('stripe-element-errors');\n        if (event.error) {\n          displayError.textContent = event.error.message;\n        } else {\n          displayError.textContent = '';\n        }\n        this.change(event);\n      });\n\n      this.element.on('ready', this.ready);\n      this.element.on('focus', this.focus);\n      this.element.on('blur', this.blur);\n      this.element.on('escape', this.escape);\n      this.element.on('click', this.click);\n\n      this.form.addEventListener('submit', async (event) => {\n        try {\n          this.$emit('loading', true);\n          event.preventDefault();\n          const data = {\n            ...this.element,\n          };\n          if (this.amount) data.amount = this.amount;\n          const { token, error } = await this.stripe.createToken(data);\n          if (error) {\n            const errorElement = document.getElementById('stripe-element-errors');\n            errorElement.textContent = error.message;\n            this.$emit('error', error);\n            return;\n          }\n          this.$emit('token', token);\n        } catch (error) {\n          console.error(error);\n          this.$emit('error', error);\n        } finally {\n          this.$emit('loading', false);\n        }\n      });\n    });\n  },\n  methods: {\n    submit () {\n      this.$refs.submitButtonRef.click();\n    },\n    change (e) {\n      this.$emit('element-change', e);\n    },\n    ready (e) {\n      this.$emit('element-ready', e);\n    },\n    focus (e) {\n      this.$emit('element-focus', e);\n    },\n    blur (e) {\n      this.$emit('element-blur', e);\n    },\n    escape (e) {\n      this.$emit('element-escape', e);\n    },\n    click (e) {\n      this.$emit('element-click', e);\n    },\n  },\n};\n<\/script>\n\n<style scoped>\n/**\n * The CSS shown here will not be introduced in the Quickstart guide, but shows\n * how you can use CSS to style your Element's container.\n */\n.StripeElement {\n  box-sizing: border-box;\n\n  height: 40px;\n\n  padding: 10px 12px;\n\n  border: 1px solid transparent;\n  border-radius: 4px;\n  background-color: white;\n\n  box-shadow: 0 1px 3px 0 #e6ebf1;\n  -webkit-transition: box-shadow 150ms ease;\n  transition: box-shadow 150ms ease;\n}\n\n.StripeElement--focus {\n  box-shadow: 0 1px 3px 0 #cfd7df;\n}\n\n.StripeElement--invalid {\n  border-color: #fa755a;\n}\n\n.StripeElement--webkit-autofill {\n  background-color: #fefde5 !important;\n}\n\n.hide {\n  visibility: hidden;\n}\n</style>\n"]},media:void 0})},g,"data-v-38ea8814",!1,void 0,!1,function(e){return(e,t)=>(function(e,t){const n=f?t.media||"default":e,i=v[n]||(v[n]={ids:new Set,styles:[]});if(!i.ids.has(e)){i.ids.add(e);let n=t.source;if(t.map&&(n+="\n/*# sourceURL="+t.map.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t.map))))+" */"),i.element||(i.element=document.createElement("style"),i.element.type="text/css",t.media&&i.element.setAttribute("media",t.media),void 0===y&&(y=document.head||document.getElementsByTagName("head")[0]),y.appendChild(i.element)),"styleSheet"in i.element)i.styles.push(n),i.element.styleSheet.cssText=i.styles.filter(Boolean).join("\n");else{const e=i.ids.size-1,t=document.createTextNode(n),r=i.element.childNodes;r[e]&&i.element.removeChild(r[e]),r.length?i.element.insertBefore(t,r[e]):i.element.appendChild(t)}}})(e,t)},void 0,void 0);var w={install:function(e,t){var n=t.pk,i=t.stripeAccount,r=t.apiVersion,s=t.locale,a=t.elementsOptions,o=window.Stripe(n,{stripeAccount:i,apiVersion:r,locale:s}),l=o.elements(a);e.prototype.$stripe=o,e.prototype.$stripeElements=l}};t.StripeCheckout=l,t.StripeElementCard=b,t.StripeElementsPlugin=w}});
//# sourceMappingURL=18.d44d4a9819a535418278.js.map