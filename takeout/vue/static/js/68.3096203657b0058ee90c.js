webpackJsonp([68],{pFum:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=i("Cz8s"),a=i("mzkE"),s=i("GQaK"),l={data:function(){return{showPreLoading:!0,allcategory:[],scrollY:0,listHeight:[],tabActive:0,vanColHeight:0,menufooter:{},getLocationStatus:!0,failedTips:{type:"location",tips:"获取定位失败!您可以选择手动搜索地址",btnText:"手动搜索地址",link:"/pages/home/location"}}},components:{PublicHeader:o.a,PublicFooter:a.a},methods:{onLoad:function(){var t=this,e=this;e.util.request({url:"wmall/home/search/allcategory",data:{forceLocation:1,menufooter:1}}).then(function(t){e.showPreLoading=!1;var i=t.data.message;i.errno?e.util.toast(i.message,"",1e3):(e.allcategory=i.message.allcategory,e.menufooter=window.menufooter,e.$nextTick(function(){e._initScroll(),e._calculateHeight()}))}).catch(function(e){"fail"==window.forceGetLocationStatus&&(t.showPreLoading=!1,t.getLocationStatus=!1)})},onGoCategory:function(t,e){this.$router.push(this.util.getUrl({path:"pages/home/category",query:{cid:t,child_id:e}}))},selectCategory:function(t,e){if(console.log(e._constructed),e._constructed){var i=this.$refs.childCategoryItem[t];this.rigthScroll.scrollToElement(i,500)}},_initScroll:function(){var t=this;this.leftScroll=new s.a(this.$refs.leftCategoryWrapper,{click:!0}),this.rigthScroll=new s.a(this.$refs.rightCategoryWrapper,{click:!0,probeType:3}),this.rigthScroll.on("scroll",function(e){e.y<=0&&(t.scrollY=Math.abs(Math.round(e.y)));for(var i=t.listHeight.length,o=0;o<i;o++){var a=t.listHeight[o],s=t.listHeight[o+1];s&&t.scrollY>=a&&t.scrollY<s&&o!=t.tabActive&&(t.tabActive=o,t._followScroll(o))}})},_calculateHeight:function(){var t=this.$refs.childCategoryItem,e=0;this.listHeight.push(0);for(var i=0;i<t.length;i++){e+=t[i].clientHeight,this.listHeight.push(e)}},_followScroll:function(t){var e=this.$refs.leftCategoryItem[t];this.leftScroll.scrollToElement(e,300,0,-100)}},mounted:function(){var t=this;this.onLoad(),this.$nextTick(function(){var e=document.documentElement.clientHeight;if(console.log(e),t.vanColHeight=e,document.getElementById("public-header")){var i=document.getElementById("public-header").clientHeight;t.vanColHeight=t.vanColHeight-i}})}},n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"home-allcategory"}},[i("public-header",{attrs:{title:"全部分类"}}),t._v(" "),i("public-footer",{attrs:{menufooter:t.menufooter}}),t._v(" "),i("div",{staticClass:"content"},[i("van-row",[i("van-col",{style:{height:t.vanColHeight+"px"},attrs:{span:"5"}},[i("div",{ref:"leftCategoryWrapper",staticClass:"tab-list",style:{height:t.vanColHeight+"px"}},[i("div",t._l(t.allcategory,function(e,o){return i("div",{key:o,ref:"leftCategoryItem",refInFor:!0,staticClass:"tab-item",class:{active:t.tabActive==o},on:{click:function(e){return t.selectCategory(o,e)}}},[i("div",{staticClass:"category-name"},[t._v(t._s(e.title))]),t._v(" "),i("span",{staticClass:"category-num"},[t._v(t._s(e.store_num))])])}),0)])]),t._v(" "),i("van-col",{style:{height:t.vanColHeight+"px"},attrs:{span:"19"}},[i("div",{ref:"rightCategoryWrapper",style:{height:t.vanColHeight+"px"}},[i("div",t._l(t.allcategory,function(e,o){return i("div",{key:o,ref:"childCategoryItem",refInFor:!0,staticClass:"category-item"},[i("div",{staticClass:"goods-title flex-lr"},[i("div",{staticClass:"font-15"},[t._v(t._s(e.title))]),t._v(" "),i("div",{staticClass:"font-13 c-gray",on:{click:function(i){return t.onGoCategory(e.id)}}},[t._v("去频道 "),i("span",{staticClass:"icon icon-right"})])]),t._v(" "),i("div",{staticClass:"goods-group"},[e.child?i("van-row",t._l(e.child,function(o,a){return i("van-col",{key:a,attrs:{span:"8"}},[i("div",{staticClass:"goods-item",on:{click:function(i){return t.onGoCategory(e.id,o.id)}}},[i("img",{attrs:{src:o.thumb,alt:""}}),t._v(" "),i("div",{staticClass:"font-14 padding-5-t"},[t._v(t._s(o.title))]),t._v(" "),i("span",{staticClass:"goods-num"},[t._v(t._s(o.store_num))])])])}),1):i("van-row",[i("van-col",{attrs:{span:"8"}},[i("div",{staticClass:"goods-item",on:{click:function(i){return t.onGoCategory(e.id)}}},[i("img",{attrs:{src:e.thumb,alt:""}}),t._v(" "),i("div",{staticClass:"font-14 padding-5-t"},[t._v(t._s(e.title))]),t._v(" "),i("span",{staticClass:"goods-num"},[t._v(t._s(e.store_num))])])])],1)],1)])}),0)])])],1)],1),t._v(" "),t.showPreLoading?i("iloading"):t._e(),t._v(" "),t.getLocationStatus?t._e():i("failed-tips",{attrs:{failedTips:t.failedTips}})],1)},staticRenderFns:[]};var r=i("VU/8")(l,n,!1,function(t){i("zP6n")},null,null);e.default=r.exports},zP6n:function(t,e){}});
//# sourceMappingURL=68.3096203657b0058ee90c.js.map